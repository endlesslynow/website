<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lesson 6: Transitive and Intransitive Verbs</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --kurdish-red: #9E2A2B;
            --kurdish-yellow: #F5CB5C;
            --background-cream: #FFF7E0;
            --text-color: #333333;
            --kurdish-green: #4F7942;
            --light-green: #E5F0E3;
        }

        body {
            font-family: 'Nunito', Arial, sans-serif;
            line-height: 1.7;
            max-width: 800px;
            margin: 0 auto;
            padding: 15px;
            background-color: var(--background-cream);
            /* --- RESTORED BACKGROUND IMAGE --- */
            background-image: url('../kurmanji_background.png');
            background-repeat: repeat;
            background-size: 200px 200px;
            box-sizing: border-box;
            color: var(--text-color);
        }

        * {
            box-sizing: border-box;
        }

        .title-section {
            background-color: #005E30; /* Darker green for title */
            color: white;
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 12px;
            position: relative;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .title-section h1 {
            color: white;
            margin: 0;
            text-align: left;
        }

        .title-section hr {
            background-color: var(--kurdish-yellow);
            height: 4px;
            margin-top: 15px;
            margin-bottom: 0;
            border: none;
        }

        h1, h2 {
            color: var(--kurdish-red);
            font-weight: 700;
            line-height: 1.3;
        }

        h1 {
            text-align: left;
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 30px;
            color: var(--kurdish-red);
        }

        h3 {
            color: var(--kurdish-red); /* Keep h3 red */
            font-weight: 700;
            line-height: 1.3;
            font-size: 1.2rem; /* Slightly larger h3 */
            margin-top: 25px;
        }

        hr {
            border: none;
            height: 3px;
            background-color: var(--kurdish-yellow);
            margin-bottom: 25px;
        }

        .section {
            background-color: rgba(255, 255, 255, 0.9); /* Changed to half-transparent white */
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border: none;
        }

        th {
            background-color: var(--kurdish-yellow);
            color: var(--text-color);
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: var(--background-cream);
        }
         tr:nth-child(odd) {
            background-color: #FEFDFB; /* Lighter cream for odd rows */
        }

        tr:hover {
            background-color: #FFEEB4; /* Keep hover effect */
        }

        .note {
            background-color: #FFF2C2; /* Light yellow for notes */
            padding: 15px;
            border-left: 4px solid var(--kurdish-yellow);
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        .highlight {
            font-weight: 700;
            color: var(--kurdish-red);
        }

        .examples {
            background-color: var(--background-cream);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .examples p:not(:first-of-type) {
            margin: 10px 0;
            padding: 10px;
            border-radius: 6px;
        }

        /* Alternating background colors for example sentences */
        .examples p:nth-of-type(even) {
            background-color: #FFF2C2;
        }

        .examples p:nth-of-type(odd):not(:first-of-type) {
            background-color: #FBEAA6;
        }

        .exercise { /* General container for any exercise block */
            background-color: #E5F0E3; /* Light green for exercise sections */
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0;
        }

        .check-btn { /* General check button style */
            background-color: var(--kurdish-yellow);
            color: var(--text-color);
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            font-family: inherit;
            font-weight: 600;
            margin-top: 10px; /* Added margin for spacing */
        }

        .check-btn:hover {
            background-color: #DBA53A; /* Darker yellow on hover */
        }

        .feedback { /* General feedback style */
            margin-top: 8px;
            margin-left: 5px;
            font-weight: bold;
            min-height: 1.5em; /* Reserve space */
        }

        .correct {
            color: #4F7942; /* Green for correct */
        }

        .incorrect {
            color: var(--kurdish-red); /* Red for incorrect */
        }
         .correct-answer-display { /* Style for showing the correct answer in feedback */
             display: inline-block;
             margin-left: 5px;
             font-weight: normal;
             font-style: italic;
             color: #555; /* Greyish color */
        }


        /* Matching Game Styles */
        .matching-game {
            background-color: #FFF7E0;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .matching-container {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 20px;
        }
        .matching-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
         /* REMOVED matching-column h4 style */
         .matching-item-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
         }
        .matching-item {
            padding: 12px 15px;
            background-color: white;
            border: 2px solid var(--kurdish-yellow);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            -webkit-tap-highlight-color: transparent;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            font-weight: 500;
        }
        .matching-item:hover { background-color: #FFF2C2; }
        .matching-item.selected {
            background-color: var(--kurdish-yellow);
            color: var(--text-color);
            border-color: #DBA53A;
        }
        .matching-item.matched {
            background-color: #4F7942;
            color: white;
            border-color: #3B5A31;
            cursor: default;
            opacity: 0.7;
        }
        .matching-result { text-align: center; margin-top: 15px; }
        .matching-feedback {
            font-weight: bold;
            margin-bottom: 12px;
            min-height: 1.5em;
        }
        .matching-feedback.correct { color: var(--kurdish-green); }
        .matching-feedback.incorrect { color: var(--kurdish-red); }
        .match-progress {
            margin-bottom: 15px;
            font-weight: 600;
            color: var(--text-color);
        }
         .match-progress .matches-count { font-weight: 700; }


        /* Fill-in Exercise (Subjunctive - Style EXACTLY like Ukrainian Ex 3) */
        .fill-exercise { /* Container for the whole fill-in exercise section */
             background-color: var(--light-green); /* Match general exercise background */
             padding: 20px;
             border-radius: 8px;
             margin: 25px 0;
        }
        .fill-item { /* Container for each question/input pair */
            background-color: white; /* White background for each item */
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .exercise-row { /* Row containing sentence parts and input */
            display: flex;
            align-items: baseline; /* Align text and input nicely */
            gap: 8px;
            margin-bottom: 10px;
            flex-wrap: wrap;
            color: var(--text-color);
            font-weight: 500;
            line-height: 1.8; /* Improve spacing with input */
        }
        .fill-input { /* Input field style */
            width: 150px; /* Adjust width as needed */
            padding: 8px 12px;
            border: 2px solid var(--kurdish-yellow);
            border-radius: 6px;
            font-size: 16px;
            font-family: inherit;
            margin: 0 5px; /* Add some horizontal margin */
            background-color: #f8f8f8; /* Slightly greyed out for readonly */
            text-align: center; /* Center text in input */
        }
        .fill-input:focus { outline: none; } /* Remove focus outline for readonly */
        .verb-hint { /* Style for the hint like (çûn - to go) */
             font-size: 0.9em;
             color: #555;
             margin-left: 5px;
         }
        .key-container { /* Container for clickable key buttons */
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
            margin-top: 8px; /* Add space above keys */
        }
        .key-btn { /* Style for individual key buttons */
            padding: 5px 12px;
            background-color: var(--background-cream);
            border: 1px solid var(--kurdish-yellow);
            border-radius: 6px;
            cursor: pointer;
            color: var(--text-color);
            font-size: 0.9em;
            font-family: inherit;
            text-align: center;
        }
        .key-btn:hover { background-color: var(--kurdish-yellow); }
        .fill-check { /* Check button specific to fill-in exercises */
            background-color: var(--kurdish-yellow);
            color: var(--text-color);
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            font-weight: 600;
            transition: background-color 0.2s ease;
            display: block; /* Make button block level */
            margin-top: 10px; /* Add margin */
        }
        .fill-check:hover { background-color: #DBA53A; }
        .fill-feedback { /* Feedback specific to fill-in exercises */
            margin-top: 10px;
            font-weight: bold;
            min-height: 1.5em; /* Reserve space */
        }
        .fill-feedback.correct { color: var(--kurdish-green); }
        .fill-feedback.incorrect { color: var(--kurdish-red); }


        /* Dialogue box styles */
        .dialogue-box {
            background-color: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .dialogue-line { margin-bottom: 10px; }
        .speaker { font-weight: bold; color: var(--kurdish-red); margin-right: 10px; }

        /* Activity card styles */
        .activities-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0; }
        .activity-card { background-color: var(--light-green); border-radius: 8px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-align: center; }
        .activity-phrase { font-weight: bold; margin-bottom: 5px; color: #4F7942; }

        /* Navigation */
        .nav-buttons-container { display: flex; justify-content: center; margin-top: 30px; margin-bottom: 40px; padding: 0 10px; }
        .nav-button { background-color: var(--kurdish-red); color: white; border: none; border-radius: 12px; padding: 15px 20px; font-family: 'Nunito', Arial, sans-serif; font-weight: 600; font-size: 1.3rem; cursor: pointer; box-shadow: 0 3px 10px rgba(0,0,0,0.1); transition: all 0.3s ease; text-decoration: none; text-align: center; display: inline-block; line-height: 1.4; }
        .nav-button:hover { background-color: #7e2223; }

        /* Vocabulary section styles */
        .vocabulary-section { background-color: var(--background-cream); padding: 20px; border-radius: 8px; margin: 20px 0; }
        .vocab-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 15px 0; }
        .vocab-item { background-color: white; border-radius: 8px; padding: 12px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .kurdish-word { font-weight: bold; color: var(--kurdish-red); margin-bottom: 5px; }

        /* Word Order Game Styles */
         .word-order-game { background-color: var(--background-cream); padding: 15px; border-radius: 8px; margin: 20px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
         .game-sentence { background-color: white; border-radius: 8px; padding: 15px; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); display: flex; flex-direction: column; }
         .game-sentence.completed { background-color: var(--light-green); border-left: 4px solid var(--kurdish-green); }
         .game-sentence-translation { font-weight: 600; margin-bottom: 15px; color: var(--text-color); }
         .sentence-number { display: inline-block; min-width: 45px; font-weight: 700; color: var(--kurdish-red); }
         .solution-area { min-height: 60px; padding: 10px; background-color: #f1f8e9; border-radius: 8px; display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 10px; border: 2px dashed var(--kurdish-green); }
         .words-bank { display: flex; flex-wrap: wrap; gap: 8px; padding: 10px; background-color: #FFF7E0; border-radius: 6px; margin-bottom: 10px; }
         .word-box { display: inline-block; padding: 8px 12px; background-color: var(--kurdish-yellow); color: var(--text-color); border-radius: 5px; cursor: pointer; user-select: none; margin: 0; font-weight: 500; border: 2px solid transparent; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.2s ease; }
         .solution-area .word-box { background-color: #beddb0; border-color: var(--kurdish-green); }
         .word-box:active { transform: scale(0.95); }
         .word-box.modal { background-color: var(--kurdish-red); color: white; }
         .solution-area .word-box.modal { background-color: #c35758; color: white; }
         .game-feedback { margin-top: 10px; font-weight: 600; min-height: 1.5em; }
         .feedback-correct { color: var(--kurdish-green); }
         .feedback-incorrect { color: var(--kurdish-red); }
         .sentence-buttons { display: flex; gap: 10px; margin-top: 10px; }
         .word-order-game .check-btn,
         .word-order-game .show-answer-btn,
         .word-order-game .delete-btn { flex: 1; padding: 8px 15px; margin-top: 0; }
         .word-order-game .show-answer-btn { background-color: #E5F0E3; }
         .word-order-game .show-answer-btn:hover { background-color: #D5E0D3; }
         .word-order-game .delete-btn { background-color: #ef9a9a; color: var(--text-color); }
         .word-order-game .delete-btn:hover { background-color: #ef5350; color: white; }

        /* Translation button */
        .trans-btn { background-color: var(--kurdish-yellow); border: none; border-radius: 4px; padding: 3px 8px; margin-left: 10px; font-size: 0.8em; cursor: pointer; transition: background-color 0.2s; }
        .trans-btn:hover { background-color: #EAB72C; }
        .translation { display: none; font-style: italic; color: #666; margin-top: 5px; padding-left: 60px; }

        /* Completion Banner */
         .completion-banner { background-color: var(--kurdish-green); padding: 25px; border-radius: 12px; text-align: center; margin: 30px 0; color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.15); }
         .completion-banner h2 { color: white; font-size: 1.7rem; margin-top: 0; }
         .celebration { font-size: 2.5rem; margin: 10px 0; }

        /* Media Queries */
        @media (max-width: 600px) {
            .section, .title-section, .exercise, .fill-exercise, .matching-game, .word-order-game { padding: 20px 15px; border-radius: 10px; }
            h1 { font-size: 1.6rem; } h2 { font-size: 1.3rem; } h3 { font-size: 1.1rem; }
            table { display: block; overflow-x: auto; white-space: nowrap; } th, td { padding: 10px 12px; } th { font-size: 0.9rem; padding: 10px 8px; }
            body { padding: 10px; }
            .check-btn { margin-top: 10px; width: 100%; max-width: 300px; padding: 12px; }
            .feedback { display: block; margin-top: 8px; }
            .matching-container { flex-direction: column; gap: 15px; }
            .matching-item { font-size: 1em; padding: 10px 12px; }
            /* Fill-in exercise mobile */
            .exercise-row { flex-direction: column; align-items: flex-start; gap: 5px;}
            .fill-input { width: 100%; max-width: none; margin: 5px 0; }
            .key-container { justify-content: flex-start; }
            .fill-check { width: auto; margin-top: 10px; }
            .activities-grid, .vocab-grid { grid-template-columns: 1fr; }
            .nav-buttons-container { flex-direction: column; gap: 15px; }
            .nav-button { width: 100%; margin: 0; font-size: 1rem; }
            /* Word order game mobile */
             .sentence-buttons { flex-direction: column; }
             .word-order-game .check-btn,
             .word-order-game .show-answer-btn,
             .word-order-game .delete-btn { width: 100%; }
             .translation { padding-left: 10px; }
        }
        @media (max-width: 450px) {
            .matching-item { padding: 10px 8px; font-size: 0.9em; }
            .matching-column { gap: 8px; }
            .matching-container { gap: 8px; }
            .key-btn { font-size: 0.8em; padding: 4px 8px;}
            .nav-button { padding: 12px 15px; }
            .word-box { padding: 6px 10px; font-size: 0.9em;}
        }
    </style>
</head>
<body>
    <div class="title-section">
        <h1>Lesson 6: <br>Transitive and Intransitive Verbs</h1>
        <hr>
    </div>

    <div class="section">
        <h3>Lesson Objectives</h3>
        <ul>
             <li><a href="#prepositions-review" style="color: inherit; text-decoration: none;">Review: The Subjunctive Form</a></li>
             <li><a href="#modal-verbs" style="color: inherit; text-decoration: none;">Transitive and Intransitive Verbs</a></li>
             <li><a href="#subjunctive" style="color: inherit; text-decoration: none;">Past Tense Rules</a></li>
             <li><a href="#standard-verbs" style="color: inherit; text-decoration: none;">Past Continuous Tense</a></li>
             <li><a href="#word-order-game" style="color: inherit; text-decoration: none;">Word Order</a></li>
             <li><a href="#dialogue" style="color: inherit; text-decoration: none;">Dialogue</a></li>
        </ul>
    </div>

    <div class="section" id="prepositions-review">
        <h2>1. Review: The Subjunctive Form</h2>
        <p>Let's review the subjunctive form we learned in the previous lesson:</p>
        <p>The <b>subjunctive form is used after modal verbs</b> to express the main action. In Kurmanji, the subjunctive is formed by:</p>
        <ol><li>Replacing the <strong>di-</strong> prefix with a <strong>bi-</strong> prefix (usually)</li><li>Adding the same set of personal endings as in the present tense</li></ol>
        
        <table>
            <tr><th>Modal Verb + Subjunctive</th><th>English Translation</th></tr>
            <tr><td><strong>Ez dikarim</strong> Kurdî <strong>biaxivim</strong>.</td><td>I <strong>can speak</strong> Kurdish.</td></tr>
            <tr><td><strong>Ew divê</strong> sibê <strong>bê</strong>.</td><td>He/She <strong>must come</strong> tomorrow.</td></tr>
            <tr><td><strong>Em dixwazin</strong> <strong>biçin</strong> mal.</td><td>We <strong>want to go</strong> home.</td></tr>
            <tr><td>Ez dixwazim deriyî <strong>vekim</strong>.</td><td>I want to <strong>open</strong> the door.</td></tr>
            <tr><td>Em dixwazin <strong>derkevin</strong>.</td><td>We want to <strong>exit</strong>.</td></tr>
            <tr><td>Ew dixwaze pirtûkê <strong>wergire</strong>.</td><td>He/She wants to <strong>take</strong> the book.</td></tr>
            <tr><td>Ez dixwazim <strong>neçim</strong>.</td><td>I want <strong>not to go</strong>.</td></tr>
            <tr><td>Ew divê <strong>nexwe</strong>.</td><td>He/She must <strong>not eat</strong>.</td></tr>
            <tr><td>Tu dikarî <strong>neaxivî</strong>.</td><td>You can <strong>not speak</strong>.</td></tr>
        </table>
        
        <p><strong>Note:</strong> In compound verbs like <strong>vekirin</strong> (to open), <strong>derkirin</strong> (to exit), or <strong>werkirin</strong> (to take), the <strong>bi-</strong> prefix is often omitted. For negation, the subjunctive uses <strong>ne-</strong> instead of the <strong>bi-</strong> prefix.</p>
        
        <div class="fill-exercise">
             <h3>Exercise 1: Fill in the Subjunctive Form</h3>

             <div class="fill-item" data-correct="biçim">
                 <div class="exercise-row">
                     <span>Ez dixwazim malê</span>
                     <input type="text" class="fill-input" id="fill-subjunctive-ex1-1" readonly>
                     <span>.</span><span class="verb-hint">(çûn - to go)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">biçim</button>
                     <button class="key-btn">diçim</button>
                     <button class="key-btn">çûm</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive-ex1-1-feedback"></div>
             </div>

             <div class="fill-item" data-correct="bixwî">
                 <div class="exercise-row">
                     <span>Tu dikarî pirtûkê</span>
                     <input type="text" class="fill-input" id="fill-subjunctive-ex1-2" readonly>
                     <span>?</span><span class="verb-hint">(xwendin - to read)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">dixwînî</button>
                     <button class="key-btn">bixwî</button>
                     <button class="key-btn">xwendî</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive-ex1-2-feedback"></div>
             </div>

             <div class="fill-item" data-correct="bê">
                 <div class="exercise-row">
                     <span>Divê ew sibê</span>
                     <input type="text" class="fill-input" id="fill-subjunctive-ex1-3" readonly>
                     <span>.</span><span class="verb-hint">(hatin - to come)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">tê</button>
                     <button class="key-btn">bê</button>
                     <button class="key-btn">dihat</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive-ex1-3-feedback"></div>
             </div>

             <div class="fill-item" data-correct="vekin">
                 <div class="exercise-row">
                     <span>Em dixwazin derî</span>
                     <input type="text" class="fill-input" id="fill-subjunctive-ex1-4" readonly>
                     <span>.</span><span class="verb-hint">(vekirin - to open)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">divekin</button>
                     <button class="key-btn">bivekin</button>
                     <button class="key-btn">vekin</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive-ex1-4-feedback"></div>
             </div>

             <div class="fill-item" data-correct="nexwim">
                 <div class="exercise-row">
                     <span>Ez dixwazim</span>
                     <input type="text" class="fill-input" id="fill-subjunctive-ex1-5" readonly>
                     <span>.</span><span class="verb-hint">(xwarin - not to eat)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">nexwim</button>
                     <button class="key-btn">naxwim</button>
                     <button class="key-btn">bixwim</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive-ex1-5-feedback"></div>
             </div>

              <div class="fill-item" data-correct="wergirin">
                 <div class="exercise-row">
                     <span>Hûn dikarin pirtûkê</span>
                     <input type="text" class="fill-input" id="fill-subjunctive-ex1-6" readonly>
                     <span>.</span><span class="verb-hint">(wergirtin - to take/receive)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">werdigirin</button>
                     <button class="key-btn">biwergirin</button>
                     <button class="key-btn">wergirin</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive-ex1-6-feedback"></div>
             </div>

             <div class="fill-item" data-correct="nebêjim">
                 <div class="exercise-row">
                     <span>Divê ez</span>
                     <input type="text" class="fill-input" id="fill-subjunctive-ex1-7" readonly>
                     <span>.</span><span class="verb-hint">(gotin - not to say)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">nabêjim</button>
                     <button class="key-btn">bibêjim</button>
                     <button class="key-btn">nebêjim</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive-ex1-7-feedback"></div>
             </div>

             <div class="fill-item" data-correct="bixebitin">
                 <div class="exercise-row">
                     <span>Divê hûn</span>
                     <input type="text" class="fill-input" id="fill-subjunctive-ex1-8" readonly>
                     <span>.</span><span class="verb-hint">(xebitîn - to work)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">dixebitin</button>
                     <button class="key-btn">bixebitin</button>
                     <button class="key-btn">xebitin</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive-ex1-8-feedback"></div>
             </div>
         </div>
    </div>

    <div class="section" id="modal-verbs">
        <h2>2. Transitive and Intransitive Verbs</h2>
        <p>A transitive verb is a verb that does something to a noun. For example I <b>eat</b> the apple. (the apple is being eaten) Or, it could even be. I <b>see</b> the apple. (the apple is being seeing)</p>
        <p>Intransitive verbs are the opposite. I <b>go</b> home. Children <b>play</b> in the street. She <b>wakes up</b> late every day. In present tense, sentences with transitive and intransitive verbs have the same formula.</p>
        
        <h3>Transitive Verb Examples:</h3>
        <table>
            <tr><th>Kurmanji</th><th>English</th></tr>
            <tr><td>Ez sêvê <b>dixwim</b>.</td><td>I <b>eat</b> the apple.</td></tr>
            <tr><td>Tu pirtûkê <b>dibînî</b>.</td><td>You <b>see</b> the book.</td></tr>
            <tr><td>Ew nameyan <b>dinivîse</b>.</td><td>He/She <b>writes</b> letters.</td></tr>
        </table>
        
        <h3>Intransitive Verb Examples:</h3>
        <table>
            <tr><th>Kurmanji</th><th>English</th></tr>
            <tr><td>Ez <b>diçim</b> malê.</td><td>I <b>go</b> home.</td></tr>
            <tr><td>Zarok <b>dilîzin</b>.</td><td>Children <b>play</b>.</td></tr>
            <tr><td>Ew <b>radikeve</b>.</td><td>He/She <b>sleeps</b>.</td></tr>
        </table>
        
        <div class="exercise">
            <h3>Exercise 2: Identify the Verb Type</h3>
            <div class="fill-exercise" style="background-color: #E5F0E3;">
                <div class="fill-item" data-correct="Transitive">
                    <div class="exercise-row">
                        <span><strong>xwarin</strong> (to eat) is a</span>
                        <input type="text" class="fill-input" id="verb-type-1" readonly>
                        <span>verb.</span>
                    </div>
                    <div class="key-container">
                        <button class="key-btn">Transitive</button>
                        <button class="key-btn">Intransitive</button>
                    </div>
                    <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                    <div class="fill-feedback" id="verb-type-1-feedback"></div>
                </div>

                <div class="fill-item" data-correct="Intransitive">
                    <div class="exercise-row">
                        <span><strong>çûn</strong> (to go) is a</span>
                        <input type="text" class="fill-input" id="verb-type-2" readonly>
                        <span>verb.</span>
                    </div>
                    <div class="key-container">
                        <button class="key-btn">Transitive</button>
                        <button class="key-btn">Intransitive</button>
                    </div>
                    <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                    <div class="fill-feedback" id="verb-type-2-feedback"></div>
                </div>

                <div class="fill-item" data-correct="Transitive">
                    <div class="exercise-row">
                        <span><strong>nivîsîn</strong> (to write) is a</span>
                        <input type="text" class="fill-input" id="verb-type-3" readonly>
                        <span>verb.</span>
                    </div>
                    <div class="key-container">
                        <button class="key-btn">Transitive</button>
                        <button class="key-btn">Intransitive</button>
                    </div>
                    <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                    <div class="fill-feedback" id="verb-type-3-feedback"></div>
                </div>

                <div class="fill-item" data-correct="Intransitive">
                    <div class="exercise-row">
                        <span><strong>hatin</strong> (to come) is a</span>
                        <input type="text" class="fill-input" id="verb-type-4" readonly>
                        <span>verb.</span>
                    </div>
                    <div class="key-container">
                        <button class="key-btn">Transitive</button>
                        <button class="key-btn">Intransitive</button>
                    </div>
                    <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                    <div class="fill-feedback" id="verb-type-4-feedback"></div>
                </div>

                <div class="fill-item" data-correct="Transitive">
                    <div class="exercise-row">
                        <span><strong>kirîn</strong> (to buy) is a</span>
                        <input type="text" class="fill-input" id="verb-type-5" readonly>
                        <span>verb.</span>
                    </div>
                    <div class="key-container">
                        <button class="key-btn">Transitive</button>
                        <button class="key-btn">Intransitive</button>
                    </div>
                    <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                    <div class="fill-feedback" id="verb-type-5-feedback"></div>
                </div>

                <div class="fill-item" data-correct="Intransitive">
                    <div class="exercise-row">
                        <span><strong>meşîn</strong> (to walk) is a</span>
                        <input type="text" class="fill-input" id="verb-type-6" readonly>
                        <span>verb.</span>
                    </div>
                    <div class="key-container">
                        <button class="key-btn">Transitive</button>
                        <button class="key-btn">Intransitive</button>
                    </div>
                    <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                    <div class="fill-feedback" id="verb-type-6-feedback"></div>
                </div>

                <div class="fill-item" data-correct="Transitive">
                    <div class="exercise-row">
                        <span><strong>dîtin</strong> (to see) is a</span>
                        <input type="text" class="fill-input" id="verb-type-7" readonly>
                        <span>verb.</span>
                    </div>
                    <div class="key-container">
                        <button class="key-btn">Transitive</button>
                        <button class="key-btn">Intransitive</button>
                    </div>
                    <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                    <div class="fill-feedback" id="verb-type-7-feedback"></div>
                </div>

                <div class="fill-item" data-correct="Intransitive">
                    <div class="exercise-row">
                        <span><strong>kenîn</strong> (to laugh) is a</span>
                        <input type="text" class="fill-input" id="verb-type-8" readonly>
                        <span>verb.</span>
                    </div>
                    <div class="key-container">
                        <button class="key-btn">Transitive</button>
                        <button class="key-btn">Intransitive</button>
                    </div>
                    <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                    <div class="fill-feedback" id="verb-type-8-feedback"></div>
                </div>
            </div>
        </div>

    <div class="section" id="subjunctive">
        <h2>3. Past Tense Rules</h2>
        <p>This is where it gets interesting!</p>
        
        <h3>Intransitive Verbs:</h3>
        <ul>
            <li>Subject stays in direct case</li>
            <li>Verb agrees with subject</li>
        </ul>
        <div class="examples">
            <p><strong>Example:</strong></p>
            <p><strong>Ez</strong> duh li mala xwe <strong>razam</strong>. (I slept at my house yesterday.)</p>
            <p><em>Ez</em> = subject in direct case</p>
        </div>
        
        <h3>Transitive Verbs:</h3>
        <ul>
            <li>Subject changes to oblique case</li>
            <li>Object uses direct case</li>
            <li>Verb agrees with object (not subject)</li>
        </ul>
        <div class="examples">
            <p><strong>Example:</strong></p>
            <p><strong>Min</strong> pirtûk <strong>xwend</strong>. (I read the book.)</p>
            <p><em>Min</em> = subject in oblique case (not <em>Ez</em>)</p>
            <p><em>pirtûk</em> = object in direct case</p>
            <p>Verb agrees with <em>pirtûk</em> (the book), not with <em>Min</em> (I)</p>
        </div>
        
         <div class="fill-exercise">
             <h3>Exercise 3: Fill in the Correct Form</h3>


             <div class="fill-item" data-correct="Ez">
                 <div class="exercise-row">
                     <span></span>
                     <input type="text" class="fill-input" id="fill-subjunctive1" readonly>
                     <span>duh li mala xwe razam.</span><span class="verb-hint">(I slept at my house yesterday - Intransitive)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">Ez</button>
                     <button class="key-btn">Min</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive1-feedback"></div>
             </div>

             <div class="fill-item" data-correct="Min">
                 <div class="exercise-row">
                     <span></span>
                     <input type="text" class="fill-input" id="fill-subjunctive2" readonly>
                     <span>pirtûk xwend.</span><span class="verb-hint">(I read a book - Transitive)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">Ez</button>
                     <button class="key-btn">Min</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive2-feedback"></div>
             </div>

             <div class="fill-item" data-correct="Tu">
                 <div class="exercise-row">
                     <span></span>
                     <input type="text" class="fill-input" id="fill-subjunctive3" readonly>
                     <span>çûyî bazarê.</span><span class="verb-hint">(You went to the market - Intransitive)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">Tu</button>
                     <button class="key-btn">Te</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive3-feedback"></div>
             </div>

             <div class="fill-item" data-correct="Te">
                 <div class="exercise-row">
                     <span></span>
                     <input type="text" class="fill-input" id="fill-subjunctive4" readonly>
                     <span>name nivîsî.</span><span class="verb-hint">(You wrote a letter - Transitive)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">Tu</button>
                     <button class="key-btn">Te</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive4-feedback"></div>
             </div>

             <div class="fill-item" data-correct="Ew">
                 <div class="exercise-row">
                     <span></span>
                     <input type="text" class="fill-input" id="fill-subjunctive5" readonly>
                     <span>hat malê.</span><span class="verb-hint">(He/She came home - Intransitive)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">Ew</button>
                     <button class="key-btn">Wî/Wê</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive5-feedback"></div>
             </div>

              <div class="fill-item" data-correct="Wî">
                 <div class="exercise-row">
                     <span></span>
                     <input type="text" class="fill-input" id="fill-subjunctive6" readonly>
                     <span>xwarin çêkir.</span><span class="verb-hint">(He prepared food - Transitive)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">Ew</button>
                     <button class="key-btn">Wî</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive6-feedback"></div>
             </div>

             <div class="fill-item" data-correct="Em">
                 <div class="exercise-row">
                     <span></span>
                     <input type="text" class="fill-input" id="fill-subjunctive7" readonly>
                     <span>li parkê rûniştin.</span><span class="verb-hint">(We sat in the park - Intransitive)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">Em</button>
                     <button class="key-btn">Me</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive7-feedback"></div>
             </div>

             <div class="fill-item" data-correct="Me">
                 <div class="exercise-row">
                     <span></span>
                     <input type="text" class="fill-input" id="fill-subjunctive8" readonly>
                     <span>pirtûk xwendin.</span><span class="verb-hint">(We read books - Transitive)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">Em</button>
                     <button class="key-btn">Me</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive8-feedback"></div>
             </div>

             <div class="fill-item" data-correct="Ez">
                 <div class="exercise-row">
                     <span></span>
                     <input type="text" class="fill-input" id="fill-subjunctive9" readonly>
                     <span>li vir raketim.</span><span class="verb-hint">(I slept here - Intransitive)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">Ez</button>
                     <button class="key-btn">Min</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive9-feedback"></div>
             </div>

             <div class="fill-item" data-correct="Min">
                 <div class="exercise-row">
                     <span></span>
                     <input type="text" class="fill-input" id="fill-subjunctive10" readonly>
                     <span>av vexwar.</span><span class="verb-hint">(I drank water - Transitive)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">Ez</button>
                     <button class="key-btn">Min</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive10-feedback"></div>
             </div>

         </div>
         </div>

    <div class="section" id="standard-verbs">
        <h2>4. Past Continuous Tense</h2>
        <p>Now, the plot will thicken. In Kurmanji Kurdish, simple past is used a lot, but past continuous is used more. You can notice this when native Kurmanji speakers talk about the past in English and usually say things in this style, "In our home we were always watching movies on Friday nights." Instead of, "In our home we always watched movies on Friday nights." If you want to speak Kurmanji perfectly, you should make the switch to using past continuous more often. Luckily it's simple.</p>
        
        <p>For conjugating a verb in past continuous tense, either transitive or intransitive verb, we prefix <strong>di-</strong> to the past stem of the verb. In this sense, the only difference from simple past tense is prefixing the <strong>di-</strong>, all other processes being the same.</p>
        <div class="examples">
            <p><strong>Examples:</strong></p>
            <p>Gava ew gihîşte malê ez <strong>dinivistim</strong>. <em>When s/he arrived at home I was sleeping.</em></p>
            <p>Rûbarê gundî mîna lehiyê <strong>diherikî</strong>. <em>The village river was flowing like a flood.</em></p>
            <p>Dema ji dukanê derket, dinya êdî tarî <strong>dibû</strong>. <em>When he got out of the shop it was getting dark.</em></p>
            <p>Gava min ew dît, wî cil û berg <strong>dikirîn</strong>. <em>When I saw him, he was buying clothes.</em></p>
        </div>
        <p>Note that the same construction is also used for expressing past habits. See the examples below:</p>
        <div class="examples">
            <p><strong>Examples:</strong></p>
            <p>Dema ez zarok bûm, ez tim <strong>hildikişiyam</strong> ser daran. <em>When I was a child, I used to climb trees.</em></p>
            <p>Hingê, em her gav bi hev re <strong>digeriyan</strong>. <em>Then, we always used to hang out together.</em></p>
            <p>Min stran <strong>digot</strong> û te jî guhdarî <strong>dikir</strong>. <em>I used to sing and you used to listen.</em></p>
        </div>
         <div class="exercise">
            <h3>Exercise 4: Match the Verb Forms</h3>
            <div class="matching-game" id="standard-verbs-matching-game">
                 <div class="matching-container">
                     <div class="matching-column">
                         <div class="matching-item-container kurdish-container"> <div class="matching-item kurdish" data-id="1">Ez çûm</div><div class="matching-item kurdish" data-id="2">Te dît</div><div class="matching-item kurdish" data-id="3">Ew ket</div><div class="matching-item kurdish" data-id="4">Min xwar</div><div class="matching-item kurdish" data-id="5">Ew hatin</div><div class="matching-item kurdish" data-id="6">We xwendin</div></div>
                     </div>
                     <div class="matching-column">
                          <div class="matching-item-container english-container"> <div class="matching-item english" data-id="1">Ez diçûm</div><div class="matching-item english" data-id="2">Te didît</div><div class="matching-item english" data-id="3">Ew diket</div><div class="matching-item english" data-id="4">Min dixwar</div><div class="matching-item english" data-id="5">Ew dihatin</div><div class="matching-item english" data-id="6">We dixwendin</div></div>
                     </div>
                 </div>
                 <div class="matching-result">
                     <div class="matching-feedback" id="standard-verbs-matching-feedback">Match each simple past form with its past continuous form</div>
                     <div class="match-progress" id="standard-verbs-match-progress">Matches: <span class="matches-count">0</span>/6</div>
                 </div>
            </div>
        </div>
        </div>

    <div class="section" id="word-order-game">
        <h2>5. Word Order Game</h2> <p>Put the words in the correct order to make sentences with transitive and intransitive verbs in past and past continuous tenses. Click on a word to place it in the solution area. Click a word in the solution area to send it back.</p>
        <div class="word-order-game">
            <div id="sentences-container"></div>
        </div>
    </div>

    <div class="section" id="dialogue">
        <h2>6. Dialogue</h2> <p>Read this dialogue that uses transitive and intransitive verbs in present, past, and past continuous tenses:</p>
        <div class="dialogue-box">
            <div class="dialogue-line"><span class="speaker">Azad:</span> Duh tu li ku bûyî? Min gelek caran telefon kir.<button class="trans-btn" onclick="toggleTranslation('trans1')">Show translation</button><div id="trans1" class="translation">Where were you yesterday? I called many times.</div></div>
            <div class="dialogue-line"><span class="speaker">Zîlan:</span> Bibexşîne. Ez li mala hevalê xwe bûm. Me dersa Kurdî dixwend.<button class="trans-btn" onclick="toggleTranslation('trans2')">Show translation</button><div id="trans2" class="translation">I'm sorry. I was at my friend's house. We were studying Kurdish.</div></div>
            <div class="dialogue-line"><span class="speaker">Azad:</span> We çi li wir dikir?<button class="trans-btn" onclick="toggleTranslation('trans3')">Show translation</button><div id="trans3" class="translation">What were you doing there?</div></div>
            <div class="dialogue-line"><span class="speaker">Zîlan:</span> Wê alîkariya min kir. Min pirtûka nû kirî lê ez tênagiheştim.<button class="trans-btn" onclick="toggleTranslation('trans4')">Show translation</button><div id="trans4" class="translation">She helped me. I bought a new book but I didn't understand it.</div></div>
            <div class="dialogue-line"><span class="speaker">Azad:</span> Çima te ji min nepirsî? Ez her dem diçim dibistana Kurdî.<button class="trans-btn" onclick="toggleTranslation('trans5')">Show translation</button><div id="trans5" class="translation">Why didn't you ask me? I always go to Kurdish school.</div></div>
            <div class="dialogue-line"><span class="speaker">Zîlan:</span> Rast e. Te çend sal Kurdî xwend?<button class="trans-btn" onclick="toggleTranslation('trans6')">Show translation</button><div id="trans6" class="translation">That's right. How many years did you study Kurdish?</div></div>
            <div class="dialogue-line"><span class="speaker">Azad:</span> Min sê sal xwend. Dema ez biçûk bûm, em diçûn gund û min bi zarokên gundî re diaxivî.<button class="trans-btn" onclick="toggleTranslation('trans7')">Show translation</button><div id="trans7" class="translation">I studied for three years. When I was small, we used to go to the village and I would speak with the village children.</div></div>
            <div class="dialogue-line"><span class="speaker">Zîlan:</span> Baş e! Tu dikarî îro min hîn bikî?<button class="trans-btn" onclick="toggleTranslation('trans8')">Show translation</button><div id="trans8" class="translation">Great! Can you teach me today?</div></div>
            <div class="dialogue-line"><span class="speaker">Azad:</span> Erê, ez dikarim. Lê divê em pirtûka te bînin. Te li ku danî?<button class="trans-btn" onclick="toggleTranslation('trans9')">Show translation</button><div id="trans9" class="translation">Yes, I can. But we need to bring your book. Where did you put it?</div></div>
            <div class="dialogue-line"><span class="speaker">Zîlan:</span> Min li ser maseyê hişt. Em dikarin niha biçin û bistînin.<button class="trans-btn" onclick="toggleTranslation('trans10')">Show translation</button><div id="trans10" class="translation">I left it on the table. We can go now and get it.</div></div>
        </div>
    </div>
    <div class="section">
        <div class="completion-banner">
            <div class="celebration">🌟 🌟 🌟</div>
            <h2>Pîroz be! Te Waneya 6 qedand!</h2>
            <p>Congratulations! You've completed Lesson 6!</p>
            <div class="celebration">🌟 🌟 🌟</div>
        </div>
    </div>

    <div class="nav-buttons-container">
        <a href="../kl_lessons_en.html" class="nav-button">Back to all lessons</a>
    </div>

    <script>
        // --- Utility Functions ---
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }
        function arraysEqual(a, b) {
            if (a.length !== b.length) return false;
            return a.every((val, index) => val === b[index]);
        }

        // --- Matching Game Logic ---
        function initializeMatchingGame(gameId, totalPairs) {
            const gameElement = document.getElementById(gameId);
            if (!gameElement) { console.error(`Matching game element not found: ${gameId}`); return; }
            const kurdishContainer = gameElement.querySelector('.matching-item-container.kurdish-container');
            const englishContainer = gameElement.querySelector('.matching-item-container.english-container');
            const feedbackElement = gameElement.querySelector('.matching-feedback');
            const matchesCountElement = gameElement.querySelector('.matches-count');

            if (!kurdishContainer || !englishContainer || !feedbackElement || !matchesCountElement) {
                 console.error(`Missing elements within matching game: ${gameId}`); return;
            }

            let selected = { kurdish: null, english: null };
            let matchCount = 0;
            matchesCountElement.textContent = matchCount; // Initialize count display

            // --- SHUFFLING ---
            // Shuffle items within each column to ensure randomization
            const kurdishItems = Array.from(kurdishContainer.children);
            shuffleArray(kurdishItems).forEach(item => kurdishContainer.appendChild(item));

            const englishItems = Array.from(englishContainer.children);
            shuffleArray(englishItems).forEach(item => englishContainer.appendChild(item));
            // --- END SHUFFLING ---

            const items = gameElement.querySelectorAll('.matching-item');

            items.forEach(item => {
                const newItem = item.cloneNode(true); // Clone to remove old listeners
                item.parentNode.replaceChild(newItem, item);

                newItem.addEventListener('click', function() {
                    if (this.classList.contains('matched')) return;
                    const isKurdish = this.classList.contains('kurdish');
                    const side = isKurdish ? 'kurdish' : 'english';

                    if (selected[side]) { selected[side].classList.remove('selected'); }
                    this.classList.add('selected');
                    selected[side] = this;

                    feedbackElement.textContent = '';
                    feedbackElement.className = 'matching-feedback';

                    if (selected.kurdish && selected.english) {
                        if (selected.kurdish.dataset.id === selected.english.dataset.id) {
                            selected.kurdish.classList.remove('selected');
                            selected.english.classList.remove('selected');
                            selected.kurdish.classList.add('matched');
                            selected.english.classList.add('matched');
                            matchCount++;
                            matchesCountElement.textContent = matchCount;
                            feedbackElement.textContent = '✓ Correct!';
                            feedbackElement.classList.add('correct');
                            if (matchCount === totalPairs) { feedbackElement.textContent = ' Well done! All matched!'; }
                            selected = { kurdish: null, english: null };
                        } else {
                            feedbackElement.textContent = '✗ Incorrect. Try again!';
                            feedbackElement.classList.add('incorrect');
                            const selK = selected.kurdish; const selE = selected.english;
                            setTimeout(() => {
                                if(selK) selK.classList.remove('selected');
                                if(selE) selE.classList.remove('selected');
                            }, 800);
                            selected = { kurdish: null, english: null };
                        }
                    }
                });
                 newItem.addEventListener('touchstart', function() { this.style.opacity = '0.7'; });
                 newItem.addEventListener('touchend', function() { this.style.opacity = '1'; });
            });
        }


        // --- Fill-in Exercise Logic (Subjunctive - EXACTLY like Ukrainian Ex 3) ---
        function initializeFillInKeys() {
             // Add click listener to all key buttons within .fill-exercise
             document.querySelectorAll('.fill-exercise .key-btn').forEach(button => {
                 button.addEventListener('click', function() {
                     const fillItem = this.closest('.fill-item'); // Find the parent exercise item
                     if (!fillItem) return;
                     const input = fillItem.querySelector('.fill-input'); // Find the input within that item
                     if (input) {
                         input.value = this.textContent; // Set input value to button text
                         // Clear feedback
                         const feedback = fillItem.querySelector('.fill-feedback');
                         if(feedback) {
                             feedback.textContent = '';
                             feedback.className = 'fill-feedback';
                         }
                         input.style.borderColor = "var(--kurdish-yellow)"; // Reset border
                         input.style.backgroundColor = "#f8f8f8"; // Reset background
                     }
                 });
             });

             // Shuffle keys within each key container
             document.querySelectorAll('.fill-exercise .key-container').forEach(container => {
                const keys = Array.from(container.children);
                shuffleArray(keys).forEach(key => container.appendChild(key));
             });
        }

        function checkFillAnswer(buttonElement) { // Triggered by the check button
            const item = buttonElement.closest('.fill-item');
            if (!item) return;

            const input = item.querySelector('.fill-input');
            const feedback = item.querySelector('.fill-feedback');
            const correctAnswer = item.dataset.correct;
            const userAnswer = input ? input.value : null; // Get value from input

            if (!input || !feedback) {
                 console.error(`Input or feedback element not found for item.`);
                 return;
            }

            // Trim answers for comparison
            const trimmedUserAnswer = userAnswer ? userAnswer.trim() : '';
            const trimmedCorrectAnswer = correctAnswer ? correctAnswer.trim() : '';


            if (trimmedUserAnswer && trimmedUserAnswer === trimmedCorrectAnswer) {
                feedback.textContent = "✓ Correct!";
                feedback.className = "fill-feedback correct";
                input.style.borderColor = "var(--kurdish-green)";
                input.style.backgroundColor = "#e5f0e3"; // Light green background
            } else if (trimmedUserAnswer) {
                feedback.innerHTML = `✗ Incorrect. Correct is: <span class="correct-answer-display">${correctAnswer}</span>`;
                feedback.className = "fill-feedback incorrect";
                input.style.borderColor = "var(--kurdish-red)";
                input.style.backgroundColor = "#fff0f0"; // Light red background
            } else {
                feedback.textContent = "Please select an option by clicking a button.";
                feedback.className = "fill-feedback"; // Neutral feedback
                input.style.borderColor = "var(--kurdish-yellow)";
                input.style.backgroundColor = "#f8f8f8";
            }
        }


        // --- Word Order Game Logic ---
        function initializeWordOrderGame() {
            // --- UPDATED sentencesData with user's corrections ---
            const sentencesData = [
                 { kurdish: "Ez duh çûm dibistanê.", english: "I went to school yesterday. (Intransitive)", modalVerbs: ["Ez", "çûm"] },
                 { kurdish: "Min pirtûk xwend.", english: "I read a book. (Transitive)", modalVerbs: ["Min", "xwend"] },
                 { kurdish: "Te sêv xwar.", english: "You ate an apple. (Transitive)", modalVerbs: ["Te", "xwar"] },
                 { kurdish: "Ew derket.", english: "He/she went out. (Intransitive)", modalVerbs: ["Ew", "derket"] },
                 { kurdish: "Wî name nivîsî.", english: "He wrote a letter. (Transitive)", modalVerbs: ["Wî", "nivîsî"] },
                 { kurdish: "Ez diçûm dibistanê.", english: "I was going to school. (Past Continuous - Intransitive)", modalVerbs: ["Ez", "diçûm"] },
                 { kurdish: "Min pirtûk dixwend.", english: "I was reading a book. (Past Continuous - Transitive)", modalVerbs: ["Min", "dixwend"] },
                 { kurdish: "Te didît ez dikeniyam.", english: "You were seeing I was laughing. (Past Continuous)", modalVerbs: ["Te", "didît", "dikeniyam"] }
            ];
            // --- END UPDATED sentencesData ---

            const sentences = sentencesData.map(item => ({
                original: item.kurdish,
                english: item.english,
                modalVerbs: item.modalVerbs || [],
                // Generate words array from the (potentially updated) kurdish string
                words: item.kurdish.replace(/[.?]/g, '').split(/\s+/).filter(word => word.length > 0) // Ensure no empty strings
            }));

            const gameContainer = document.getElementById('sentences-container');
            if (!gameContainer) { console.error("Word order game container 'sentences-container' not found."); return; }
            gameContainer.innerHTML = ''; // Clear previous content

            sentences.forEach((sentence, index) => {
                const sentenceElement = document.createElement('div');
                sentenceElement.className = 'game-sentence';
                sentenceElement.id = `sentence-${index}`;
                const translation = document.createElement('div');
                translation.className = 'game-sentence-translation';
                translation.innerHTML = `<span class="sentence-number">${index + 1}/${sentences.length}</span> ${sentence.english}`;
                sentenceElement.appendChild(translation);
                const solutionArea = document.createElement('div');
                solutionArea.className = 'solution-area';
                solutionArea.id = `solution-area-${index}`;
                sentenceElement.appendChild(solutionArea);
                const wordsBank = document.createElement('div');
                wordsBank.className = 'words-bank';
                wordsBank.id = `words-bank-${index}`;
                sentenceElement.appendChild(wordsBank);
                const shuffledWords = shuffleArray(sentence.words); // Shuffle the correct words
                shuffledWords.forEach(word => {
                    const wordElement = document.createElement('div');
                    wordElement.className = 'word-box';
                    wordElement.textContent = word;
                    // Check against the modalVerbs array defined in sentencesData
                    if (sentence.modalVerbs.includes(word)) {
                        wordElement.classList.add('modal');
                    }
                    wordElement.addEventListener('click', () => {
                        const parent = wordElement.parentElement;
                        const targetBank = parent.classList.contains('words-bank') ? solutionArea : wordsBank;
                        targetBank.appendChild(wordElement);
                        const feedbackElement = document.getElementById(`feedback-${index}`);
                        if(feedbackElement) { feedbackElement.textContent = ''; feedbackElement.className = 'game-feedback'; }
                    });
                    wordsBank.appendChild(wordElement);
                });
                const feedback = document.createElement('div');
                feedback.className = 'game-feedback';
                feedback.id = `feedback-${index}`;
                sentenceElement.appendChild(feedback);
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'sentence-buttons';
                const checkButton = document.createElement('button');
                checkButton.className = 'check-btn'; // Use general check-btn style
                checkButton.textContent = 'Check Answer';
                checkButton.onclick = () => checkSentence(index, sentences); // Pass sentences array
                buttonContainer.appendChild(checkButton);
                const showAnswerButton = document.createElement('button');
                showAnswerButton.className = 'show-answer-btn'; // Use specific class if needed, or general
                showAnswerButton.textContent = 'Show Answer';
                showAnswerButton.onclick = () => showAnswer(index, sentences); // Pass sentences array
                buttonContainer.appendChild(showAnswerButton);
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-btn'; // Use specific class if needed, or general
                deleteBtn.textContent = 'Clear Box';
                deleteBtn.onclick = () => {
                    const currentSolutionArea = document.getElementById(`solution-area-${index}`);
                    const currentWordsBank = document.getElementById(`words-bank-${index}`);
                    while (currentSolutionArea.firstChild) { currentWordsBank.appendChild(currentSolutionArea.firstChild); }
                     const feedbackElement = document.getElementById(`feedback-${index}`);
                     if(feedbackElement) { feedbackElement.textContent = ''; feedbackElement.className = 'game-feedback'; }
                };
                buttonContainer.appendChild(deleteBtn);
                sentenceElement.appendChild(buttonContainer);
                gameContainer.appendChild(sentenceElement);
                 if (index > 0) { sentenceElement.style.display = 'none'; }
            });
        }
        function checkSentence(sentenceId, sentences) { // Receive sentences array
            const solutionArea = document.getElementById(`solution-area-${sentenceId}`);
            const feedbackElement = document.getElementById(`feedback-${sentenceId}`);
            const sentenceElement = document.getElementById(`sentence-${sentenceId}`);
            if (!solutionArea || !feedbackElement || !sentenceElement) return;
            const currentWords = Array.from(solutionArea.children).map(word => word.textContent);
            const correctWords = sentences[sentenceId].words; // Get correct words from passed array
            if (currentWords.length !== correctWords.length) {
                feedbackElement.textContent = '✗ Please use all the words.';
                feedbackElement.className = 'game-feedback feedback-incorrect'; return;
            }
            const isCorrect = arraysEqual(currentWords, correctWords);
            if (isCorrect) {
                feedbackElement.textContent = '✓ Correct! Well done!';
                feedbackElement.className = 'game-feedback feedback-correct';
                sentenceElement.classList.add('completed');
                if (sentenceId < sentences.length - 1) {
                    setTimeout(() => {
                        const nextSentence = document.getElementById(`sentence-${sentenceId + 1}`);
                        if (nextSentence) { nextSentence.style.display = 'flex'; nextSentence.scrollIntoView({ behavior: 'smooth', block: 'center' }); }
                    }, 800);
                } else { feedbackElement.textContent = 'You completed the word order game!'; }
            } else {
                feedbackElement.textContent = '✗ Not quite right. Try again!';
                feedbackElement.className = 'game-feedback feedback-incorrect';
            }
        }
        function showAnswer(sentenceId, sentences) { // Receive sentences array
            const solutionArea = document.getElementById(`solution-area-${sentenceId}`);
            const wordsBank = document.getElementById(`words-bank-${sentenceId}`);
            const feedbackElement = document.getElementById(`feedback-${sentenceId}`);
            const sentenceElement = document.getElementById(`sentence-${sentenceId}`);
             if (!solutionArea || !wordsBank || !feedbackElement || !sentenceElement) return;
            solutionArea.innerHTML = ''; wordsBank.innerHTML = '';
            sentences[sentenceId].words.forEach(word => { // Use correct words from passed array
                const wordElement = document.createElement('div');
                wordElement.className = 'word-box'; wordElement.textContent = word;
                 // Check against the modalVerbs array defined in sentencesData
                 if (sentences[sentenceId].modalVerbs.includes(word)) {
                     wordElement.classList.add('modal');
                 }
                wordElement.style.cursor = 'default'; solutionArea.appendChild(wordElement);
            });
            feedbackElement.textContent = 'This is the correct order.';
            feedbackElement.className = 'game-feedback';
            sentenceElement.classList.add('completed');
             if (sentenceId < sentences.length - 1) {
                 setTimeout(() => {
                     const nextSentence = document.getElementById(`sentence-${sentenceId + 1}`);
                     if (nextSentence) { nextSentence.style.display = 'flex'; nextSentence.scrollIntoView({ behavior: 'smooth', block: 'center' }); }
                 }, 800);
             }
        }

        // --- Dialogue Translation Toggle ---
        function toggleTranslation(id) {
            const translation = document.getElementById(id);
            const button = translation.previousElementSibling;
            if (translation && button) {
                if (translation.style.display === 'block') {
                    translation.style.display = 'none'; button.textContent = 'Show translation';
                } else {
                    translation.style.display = 'block'; button.textContent = 'Hide translation';
                }
            }
        }

        // --- Initialization on DOM Load ---
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize all matching games with correct pair counts
            initializeMatchingGame('prepositions-matching-game', 6);
            initializeMatchingGame('modal-verbs-matching-game', 8);
            initializeMatchingGame('standard-verbs-matching-game', 6);

            // Initialize fill-in exercise functionality (keys + Enter) for Ex 3
            initializeFillInKeys();

            // Initialize word order game
            initializeWordOrderGame();
        });

    </script>

</body>
</html>