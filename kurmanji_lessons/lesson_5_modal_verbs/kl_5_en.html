<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lesson 5: Modal Verbs and Key Verbs</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --kurdish-red: #9E2A2B;
            --kurdish-yellow: #F5CB5C;
            --background-cream: #FFF7E0;
            --text-color: #333333;
            --kurdish-green: #4F7942;
            --light-green: #E5F0E3;
        }

        body {
            font-family: 'Nunito', Arial, sans-serif;
            line-height: 1.7;
            max-width: 800px;
            margin: 0 auto;
            padding: 15px;
            background-color: var(--background-cream);
            /* --- RESTORED BACKGROUND IMAGE --- */
            background-image: url('../kurmanji_background.png');
            background-repeat: repeat;
            background-size: 200px 200px;
            box-sizing: border-box;
            color: var(--text-color);
        }

        * {
            box-sizing: border-box;
        }

        .title-section {
            background-color: #005E30; /* Darker green for title */
            color: white;
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 12px;
            position: relative;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .title-section h1 {
            color: white;
            margin: 0;
            text-align: left;
        }

        .title-section hr {
            background-color: var(--kurdish-yellow);
            height: 4px;
            margin-top: 15px;
            margin-bottom: 0;
            border: none;
        }

        h1, h2 {
            color: var(--kurdish-red);
            font-weight: 700;
            line-height: 1.3;
        }

        h1 {
            text-align: left;
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 30px;
            color: var(--kurdish-red);
        }

        h3 {
            color: var(--kurdish-red); /* Keep h3 red */
            font-weight: 700;
            line-height: 1.3;
            font-size: 1.2rem; /* Slightly larger h3 */
            margin-top: 25px;
        }

        hr {
            border: none;
            height: 3px;
            background-color: var(--kurdish-yellow);
            margin-bottom: 25px;
        }

        .section {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border: none;
        }

        th {
            background-color: var(--kurdish-yellow);
            color: var(--text-color);
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: var(--background-cream);
        }
         tr:nth-child(odd) {
            background-color: #FEFDFB; /* Lighter cream for odd rows */
        }

        tr:hover {
            background-color: #FFEEB4; /* Keep hover effect */
        }

        .note {
            background-color: #FFF2C2; /* Light yellow for notes */
            padding: 15px;
            border-left: 4px solid var(--kurdish-yellow);
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        .highlight {
            font-weight: 700;
            color: var(--kurdish-red);
        }

        .examples {
            background-color: var(--background-cream);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .examples p:not(:first-of-type) {
            margin: 10px 0;
            padding: 10px;
            border-radius: 6px;
        }

        /* Alternating background colors for example sentences */
        .examples p:nth-of-type(even) {
            background-color: #FFF2C2;
        }

        .examples p:nth-of-type(odd):not(:first-of-type) {
            background-color: #FBEAA6;
        }

        .exercise { /* General container for any exercise block */
            background-color: #E5F0E3; /* Light green for exercise sections */
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0;
        }

        .check-btn { /* General check button style */
            background-color: var(--kurdish-yellow);
            color: var(--text-color);
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            font-family: inherit;
            font-weight: 600;
            margin-top: 10px; /* Added margin for spacing */
        }

        .check-btn:hover {
            background-color: #DBA53A; /* Darker yellow on hover */
        }

        .feedback { /* General feedback style */
            margin-top: 8px;
            margin-left: 5px;
            font-weight: bold;
            min-height: 1.5em; /* Reserve space */
        }

        .correct {
            color: #4F7942; /* Green for correct */
        }

        .incorrect {
            color: var(--kurdish-red); /* Red for incorrect */
        }
         .correct-answer-display { /* Style for showing the correct answer in feedback */
             display: inline-block;
             margin-left: 5px;
             font-weight: normal;
             font-style: italic;
             color: #555; /* Greyish color */
        }


        /* Matching Game Styles */
        .matching-game {
            background-color: #FFF7E0;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .matching-container {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 20px;
        }
        .matching-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
         /* REMOVED matching-column h4 style */
         .matching-item-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
         }
        .matching-item {
            padding: 12px 15px;
            background-color: white;
            border: 2px solid var(--kurdish-yellow);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            -webkit-tap-highlight-color: transparent;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            font-weight: 500;
        }
        .matching-item:hover { background-color: #FFF2C2; }
        .matching-item.selected {
            background-color: var(--kurdish-yellow);
            color: var(--text-color);
            border-color: #DBA53A;
        }
        .matching-item.matched {
            background-color: #4F7942;
            color: white;
            border-color: #3B5A31;
            cursor: default;
            opacity: 0.7;
        }
        .matching-result { text-align: center; margin-top: 15px; }
        .matching-feedback {
            font-weight: bold;
            margin-bottom: 12px;
            min-height: 1.5em;
        }
        .matching-feedback.correct { color: var(--kurdish-green); }
        .matching-feedback.incorrect { color: var(--kurdish-red); }
        .match-progress {
            margin-bottom: 15px;
            font-weight: 600;
            color: var(--text-color);
        }
         .match-progress .matches-count { font-weight: 700; }


        /* Fill-in Exercise (Subjunctive - Style EXACTLY like Ukrainian Ex 3) */
        .fill-exercise { /* Container for the whole fill-in exercise section */
             background-color: var(--light-green); /* Match general exercise background */
             padding: 20px;
             border-radius: 8px;
             margin: 25px 0;
        }
        .fill-item { /* Container for each question/input pair */
            background-color: white; /* White background for each item */
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .exercise-row { /* Row containing sentence parts and input */
            display: flex;
            align-items: baseline; /* Align text and input nicely */
            gap: 8px;
            margin-bottom: 10px;
            flex-wrap: wrap;
            color: var(--text-color);
            font-weight: 500;
            line-height: 1.8; /* Improve spacing with input */
        }
        .fill-input { /* Input field style */
            width: 150px; /* Adjust width as needed */
            padding: 8px 12px;
            border: 2px solid var(--kurdish-yellow);
            border-radius: 6px;
            font-size: 16px;
            font-family: inherit;
            margin: 0 5px; /* Add some horizontal margin */
            background-color: #f8f8f8; /* Slightly greyed out for readonly */
            text-align: center; /* Center text in input */
        }
        .fill-input:focus { outline: none; } /* Remove focus outline for readonly */
        .verb-hint { /* Style for the hint like (çûn - to go) */
             font-size: 0.9em;
             color: #555;
             margin-left: 5px;
         }
        .key-container { /* Container for clickable key buttons */
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
            margin-top: 8px; /* Add space above keys */
        }
        .key-btn { /* Style for individual key buttons */
            padding: 5px 12px;
            background-color: var(--background-cream);
            border: 1px solid var(--kurdish-yellow);
            border-radius: 6px;
            cursor: pointer;
            color: var(--text-color);
            font-size: 0.9em;
            font-family: inherit;
            text-align: center;
        }
        .key-btn:hover { background-color: var(--kurdish-yellow); }
        .fill-check { /* Check button specific to fill-in exercises */
            background-color: var(--kurdish-yellow);
            color: var(--text-color);
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            font-weight: 600;
            transition: background-color 0.2s ease;
            display: block; /* Make button block level */
            margin-top: 10px; /* Add margin */
        }
        .fill-check:hover { background-color: #DBA53A; }
        .fill-feedback { /* Feedback specific to fill-in exercises */
            margin-top: 10px;
            font-weight: bold;
            min-height: 1.5em; /* Reserve space */
        }
        .fill-feedback.correct { color: var(--kurdish-green); }
        .fill-feedback.incorrect { color: var(--kurdish-red); }


        /* Dialogue box styles */
        .dialogue-box {
            background-color: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .dialogue-line { margin-bottom: 10px; }
        .speaker { font-weight: bold; color: var(--kurdish-red); margin-right: 10px; }

        /* Activity card styles */
        .activities-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0; }
        .activity-card { background-color: var(--light-green); border-radius: 8px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-align: center; }
        .activity-phrase { font-weight: bold; margin-bottom: 5px; color: #4F7942; }

        /* Navigation */
        .nav-buttons-container { display: flex; justify-content: center; margin-top: 30px; margin-bottom: 40px; padding: 0 10px; }
        .nav-button { background-color: var(--kurdish-red); color: white; border: none; border-radius: 12px; padding: 15px 20px; font-family: 'Nunito', Arial, sans-serif; font-weight: 600; font-size: 1.3rem; cursor: pointer; box-shadow: 0 3px 10px rgba(0,0,0,0.1); transition: all 0.3s ease; text-decoration: none; text-align: center; display: inline-block; line-height: 1.4; }
        .nav-button:hover { background-color: #7e2223; }

        /* Vocabulary section styles */
        .vocabulary-section { background-color: var(--background-cream); padding: 20px; border-radius: 8px; margin: 20px 0; }
        .vocab-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 15px 0; }
        .vocab-item { background-color: white; border-radius: 8px; padding: 12px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .kurdish-word { font-weight: bold; color: var(--kurdish-red); margin-bottom: 5px; }

        /* Word Order Game Styles */
         .word-order-game { background-color: var(--background-cream); padding: 15px; border-radius: 8px; margin: 20px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
         .game-sentence { background-color: white; border-radius: 8px; padding: 15px; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); display: flex; flex-direction: column; }
         .game-sentence.completed { background-color: var(--light-green); border-left: 4px solid var(--kurdish-green); }
         .game-sentence-translation { font-weight: 600; margin-bottom: 15px; color: var(--text-color); }
         .sentence-number { display: inline-block; min-width: 45px; font-weight: 700; color: var(--kurdish-red); }
         .solution-area { min-height: 60px; padding: 10px; background-color: #f1f8e9; border-radius: 8px; display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 10px; border: 2px dashed var(--kurdish-green); }
         .words-bank { display: flex; flex-wrap: wrap; gap: 8px; padding: 10px; background-color: #FFF7E0; border-radius: 6px; margin-bottom: 10px; }
         .word-box { display: inline-block; padding: 8px 12px; background-color: var(--kurdish-yellow); color: var(--text-color); border-radius: 5px; cursor: pointer; user-select: none; margin: 0; font-weight: 500; border: 2px solid transparent; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.2s ease; }
         .solution-area .word-box { background-color: #beddb0; border-color: var(--kurdish-green); }
         .word-box:active { transform: scale(0.95); }
         .word-box.modal { background-color: var(--kurdish-red); color: white; }
         .solution-area .word-box.modal { background-color: #c35758; color: white; }
         .game-feedback { margin-top: 10px; font-weight: 600; min-height: 1.5em; }
         .feedback-correct { color: var(--kurdish-green); }
         .feedback-incorrect { color: var(--kurdish-red); }
         .sentence-buttons { display: flex; gap: 10px; margin-top: 10px; }
         .word-order-game .check-btn,
         .word-order-game .show-answer-btn,
         .word-order-game .delete-btn { flex: 1; padding: 8px 15px; margin-top: 0; }
         .word-order-game .show-answer-btn { background-color: #E5F0E3; }
         .word-order-game .show-answer-btn:hover { background-color: #D5E0D3; }
         .word-order-game .delete-btn { background-color: #ef9a9a; color: var(--text-color); }
         .word-order-game .delete-btn:hover { background-color: #ef5350; color: white; }

        /* Translation button */
        .trans-btn { background-color: var(--kurdish-yellow); border: none; border-radius: 4px; padding: 3px 8px; margin-left: 10px; font-size: 0.8em; cursor: pointer; transition: background-color 0.2s; }
        .trans-btn:hover { background-color: #EAB72C; }
        .translation { display: none; font-style: italic; color: #666; margin-top: 5px; padding-left: 60px; }

        /* Completion Banner */
         .completion-banner { background-color: var(--kurdish-green); padding: 25px; border-radius: 12px; text-align: center; margin: 30px 0; color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.15); }
         .completion-banner h2 { color: white; font-size: 1.7rem; margin-top: 0; }
         .celebration { font-size: 2.5rem; margin: 10px 0; }

        /* Media Queries */
        @media (max-width: 600px) {
            .section, .title-section, .exercise, .fill-exercise, .matching-game, .word-order-game { padding: 20px 15px; border-radius: 10px; }
            h1 { font-size: 1.6rem; } h2 { font-size: 1.3rem; } h3 { font-size: 1.1rem; }
            table { display: block; overflow-x: auto; white-space: nowrap; } th, td { padding: 10px 12px; } th { font-size: 0.9rem; padding: 10px 8px; }
            body { padding: 10px; }
            .check-btn { margin-top: 10px; width: 100%; max-width: 300px; padding: 12px; }
            .feedback { display: block; margin-top: 8px; }
            .matching-container { flex-direction: column; gap: 15px; }
            .matching-item { font-size: 1em; padding: 10px 12px; }
            /* Fill-in exercise mobile */
            .exercise-row { flex-direction: column; align-items: flex-start; gap: 5px;}
            .fill-input { width: 100%; max-width: none; margin: 5px 0; }
            .key-container { justify-content: flex-start; }
            .fill-check { width: auto; margin-top: 10px; }
            .activities-grid, .vocab-grid { grid-template-columns: 1fr; }
            .nav-buttons-container { flex-direction: column; gap: 15px; }
            .nav-button { width: 100%; margin: 0; font-size: 1rem; }
            /* Word order game mobile */
             .sentence-buttons { flex-direction: column; }
             .word-order-game .check-btn,
             .word-order-game .show-answer-btn,
             .word-order-game .delete-btn { width: 100%; }
             .translation { padding-left: 10px; }
        }
        @media (max-width: 450px) {
            .matching-item { padding: 10px 8px; font-size: 0.9em; }
            .matching-column { gap: 8px; }
            .matching-container { gap: 8px; }
            .key-btn { font-size: 0.8em; padding: 4px 8px;}
            .nav-button { padding: 12px 15px; }
            .word-box { padding: 6px 10px; font-size: 0.9em;}
        }
    </style>
</head>
<body>
    <div class="title-section">
        <h1>Lesson 5: <br>Modal Verbs, Subjunctive, and Key Verbs</h1>
        <hr>
    </div>

    <div class="section">
        <h3>Lesson Objectives</h3>
        <ul>
             <li><a href="#prepositions-review" style="color: inherit; text-decoration: none;">Review: Prepositions and Circumpositions</a></li>
             <li><a href="#modal-verbs" style="color: inherit; text-decoration: none;">Modal Verbs</a></li>
             <li><a href="#subjunctive" style="color: inherit; text-decoration: none;">The Subjunctive Form</a></li>
             <li><a href="#standard-verbs" style="color: inherit; text-decoration: none;">15 Important Verbs</a></li>
             <li><a href="#word-order-game" style="color: inherit; text-decoration: none;">Word Order</a></li>
             <li><a href="#dialogue" style="color: inherit; text-decoration: none;">Dialogue</a></li>
        </ul>
    </div>

    <div class="section" id="prepositions-review">
        <h2>1. Review: Prepositions and Circumpositions</h2>
        <p>Let's review the common prepositions and circumpositions we learned in the previous lesson:</p>
        <table>
            <tr><th>Preposition</th><th>Meaning</th><th>Example</th><th>Translation</th></tr>
            <tr><td>ba/nik/cem</td><td>to, towards</td><td>Ew her roj diçe <b>cem</b> hevalên xwe.</td><td>Every day he goes <b>to</b> his friends.</td></tr>
            <tr><td>bi</td><td>with, by means of</td><td>Ez <b>bi</b> bisîkletê diçim dibistanê.</td><td>I go to school <b>by</b> bicycle.</td></tr>
            <tr><td>bi ...re</td><td>with</td><td>Bisekîne! Ez jî <b>bi</b> te <b>re</b> têm bazarê.</td><td>Stop! I too will come to the market <b>with</b> you.</td></tr>
            <tr><td>bo</td><td>for, to</td><td>Ji kerema xwe <b>bo</b> min çayekî dagire.</td><td>If you would be so kind, pour a tea <b>for</b> me.</td></tr>
            <tr><td>di nav ...de</td><td>inside of, among</td><td>Tu çi dikî <b>di nav</b> avê <b>de</b>?</td><td>What are you putting <b>into</b> the water?</td></tr>
            <tr><td>di navbera ...de</td><td>between</td><td>Welatê me <b>di navbera</b> Ferat û Dîcleyê <b>de</b> ye.</td><td>Our homeland is <b>between</b> the Euphrates and the Tigris (rivers).</td></tr>
            <tr><td>heta</td><td>until</td><td>Ez <b>heta</b> saet nehê şevê kar dikim.</td><td>I am working <b>until</b> nine O'clock in the evening.</td></tr>
            <tr><td>ji</td><td>from, of</td><td>Derya <b>ji</b> Qoserê ye.</td><td>Derya is <b>from</b> Qoser.</td></tr>
            <tr><td>ji</td><td>from, of</td><td>Mast <b>ji</b> şîr çêdibe.</td><td>Yoghurt is made <b>of</b> milk.</td></tr>
            <tr><td>ji ...re</td><td>to</td><td>Ez <b>ji</b> te <b>re</b> dibêjim lê tu <b>ji</b> kesî <b>re</b> nebêje.</td><td>I tell you but don't you tell it <b>to</b> anyone (lit. no-one).</td></tr>
            <tr><td>ji...ve</td><td>from, since</td><td><b>Ji</b> saet heftê sibehê <b>ve</b> kar dikim.</td><td>I have been working <b>since</b> 7 in morning.</td></tr>
            <tr><td>ji bilî</td><td>except for, other than</td><td>Di malbata wan de <b>ji bilî</b> wî tu kes kar nake.</td><td>In their family no-one works <b>except for</b> him.</td></tr>
            <tr><td>ji bo</td><td>for</td><td>Hemî hewla min <b>ji bo</b> wî ye.</td><td>All my effort is <b>for</b> him.</td></tr>
            <tr><td>li ber</td><td>in front of</td><td>Zû were! <b>Li ber</b> bankê li hêviya te me.</td><td>Come quickly! I am waiting for you <b>in front of</b> the bank.</td></tr>
            <tr><td>li dijî</td><td>against</td><td>Em <b>li dijî</b> neheqiyê têdikoşin.</td><td>We struggle <b>against</b> injustice.</td></tr>
            <tr><td>ligel</td><td>with, along with</td><td>Kunçî jî <b>ligel</b> zarokan dilîze.</td><td>Kunçî too plays <b>with</b> the children.</td></tr>
            <tr><td>li gorî</td><td>according to</td><td><b>Li gorî</b> wî em neheq in.</td><td><b>According to</b> him, we are wrong.</td></tr>
            <tr><td>li pêş</td><td>in front of</td><td>Demhat ji dibistanê de <b>li pêş</b> Rûkenê rûdine.</td><td>Demhat sits <b>in front of</b> Rûken in the classroom.</td></tr>
            <tr><td>li rex</td><td>beside</td><td>Malên wan <b>li rex</b> hev in.</td><td>Their houses are <b>next to</b> each other.</td></tr>
            <tr><td>li ser</td><td>on, over</td><td>Bîne, deyne <b>li ser</b> vê maseyê.</td><td>Bring (it) and put (it) <b>on</b> this table!</td></tr>
            <tr><td>wekî/mîna</td><td>like, as</td><td>Rast e, ez jî <b>wekî</b> te difikirîm.</td><td>That's right, I too think <b>like</b> you / think the same way <b>as</b> you.</td></tr>
            <tr><td>piştî</td><td>after</td><td><b>Piştî</b> saet heftê êvarî vedigere malê.</td><td><b>After</b> seven O'clock in the evening (he / she) returns home.</td></tr>
        </table>
        <div class="exercise">
            <h3>Exercise 1: Match the Prepositions</h3>
            <div class="matching-game" id="prepositions-matching-game">
                 <div class="matching-container">
                     <div class="matching-column">
                         <div class="matching-item-container kurdish-container"> <div class="matching-item kurdish" data-id="1">li</div><div class="matching-item kurdish" data-id="2">ji</div><div class="matching-item kurdish" data-id="3">bi</div><div class="matching-item kurdish" data-id="4">li ser</div><div class="matching-item kurdish" data-id="5">ji bo</div><div class="matching-item kurdish" data-id="6">di...de</div><div class="matching-item kurdish" data-id="7">li ber</div><div class="matching-item kurdish" data-id="8">li dijî</div><div class="matching-item kurdish" data-id="9">ligel</div><div class="matching-item kurdish" data-id="10">piştî</div><div class="matching-item kurdish" data-id="11">wekî</div><div class="matching-item kurdish" data-id="12">heta</div></div>
                     </div>
                     <div class="matching-column">
                          <div class="matching-item-container english-container"> <div class="matching-item english" data-id="1">at, in</div><div class="matching-item english" data-id="2">from</div><div class="matching-item english" data-id="3">through, by</div><div class="matching-item english" data-id="4">on, about</div><div class="matching-item english" data-id="5">for</div><div class="matching-item english" data-id="6">inside of, among</div><div class="matching-item english" data-id="7">in front of</div><div class="matching-item english" data-id="8">against</div><div class="matching-item english" data-id="9">with, along with</div><div class="matching-item english" data-id="10">after</div><div class="matching-item english" data-id="11">like, as</div><div class="matching-item english" data-id="12">until</div></div>
                     </div>
                 </div>
                 <div class="matching-result">
                     <div class="matching-feedback" id="prepositions-matching-feedback">Select a Kurdish word and its English equivalent</div>
                     <div class="match-progress" id="prepositions-match-progress">Matches: <span class="matches-count">0</span>/12</div>
                 </div>
            </div>
        </div>
    </div>

    <div class="section" id="modal-verbs">
        <h2>2. Modal Verbs Introduction</h2>
        <p>Modal verbs are "helper verbs" that don't express an action on their own but add extra meaning to the main verb in a sentence. They express ideas like:</p>
        <ul><li><strong>Ability</strong> (can, be able to)</li><li><strong>Possibility</strong> (might, may)</li><li><strong>Necessity</strong> (must, have to)</li><li><strong>Obligation</strong> (should)</li><li><strong>Desire</strong> (want to)</li></ul>
        <p>In Kurmanji Kurdish, the most common modal verbs are:</p>
        <table>
            <tr><th>Modal Verb</th><th>Meaning</th><th>Usage</th></tr>
            <tr><td><strong>karîn</strong></td><td>can, to be able to</td><td>Changes for different subjects (ez dikarim, tu dikarî, etc.)</td></tr>
            <tr><td><strong>divê / divêt</strong></td><td>must, have to, should</td><td>Usually invariable (doesn't change form)</td></tr>
            <tr><td><strong>xwestin</strong></td><td>to want</td><td>Changes for different subjects (ez dixwazim, tu dixwazî, etc.)</td></tr>
        </table>
        <div class="note"><p>Note: "Divê" can mean either "should" or "must", which shows that Kurmanji is a very polite language!</p></div>
        <div class="exercise">
            <h3>Exercise 2: Match the Modal Verbs</h3>
            <div class="matching-game" id="modal-verbs-matching-game">
                 <div class="matching-container">
                     <div class="matching-column">
                         <div class="matching-item-container kurdish-container"> <div class="matching-item kurdish" data-id="1">karîn</div><div class="matching-item kurdish" data-id="2">divê / divêt</div><div class="matching-item kurdish" data-id="3">xwestin</div></div>
                     </div>
                     <div class="matching-column">
                          <div class="matching-item-container english-container"> <div class="matching-item english" data-id="1">can, to be able to</div><div class="matching-item english" data-id="2">must, have to, should</div><div class="matching-item english" data-id="3">to want</div></div>
                     </div>
                 </div>
                 <div class="matching-result">
                     <div class="matching-feedback" id="modal-verbs-matching-feedback">Select a Kurdish modal and its English meaning</div>
                     <div class="match-progress" id="modal-verbs-match-progress">Matches: <span class="matches-count">0</span>/3</div>
                 </div>
            </div>
        </div>
    </div>

    <div class="section" id="subjunctive">
        <h2>3. The Subjunctive Form</h2>
        <p>The <b>subjunctive form is used after modal verbs</b> to express the main action. In Kurmanji, the subjunctive is formed by:</p>
        <ol><li>Replacing the <strong>di-</strong> prefix with a <strong>bi-</strong> prefix (usually)</li><li>Adding the same set of personal endings as in the present tense</li></ol>
        <div class="examples"><p><strong>Examples:</strong></p><p><strong>Ez dikarim</strong> Kurdî <strong>biaxivim</strong>. (I <strong>can speak</strong> Kurdish.)</p><p><strong>Ew divê</strong> sibê <strong>bê</strong>. (He/She <strong>must come</strong> tomorrow.)</p><p><strong>Em dixwazin</strong> <strong>biçin</strong> mal. (We <strong>want to go</strong> home.)</p></div>
        <p>In compound verbs written as one word like <strong>vekirin</strong> (to open), <strong>derkirin</strong> (to exit), or <strong>werkirin</strong> (to take), the subjunctive prefix <strong>bi-</strong> is often omitted:</p>
        <div class="examples"><p><strong>Examples:</strong></p><p>Ez dixwazim deriyî <strong>vekim</strong>. (I want to open the door.)</p><p>Em dixwazin <strong>derkevin</strong>. (We want to exit.)</p><p>Ew dixwaze pirtûkê <strong>wergire</strong>. (He/She wants to take the book.)</p></div>
        <p><strong>Negation in the subjunctive:</strong> Unlike the present tense which uses <strong>na-</strong> for negation, the subjunctive form uses <strong>ne-</strong> for negation, and this replaces the <strong>bi-</strong> prefix:</p>
        <div class="examples"><p><strong>Examples:</strong></p><p>Ez dixwazim <strong>neçim</strong>. (I want <strong>not to go</strong>.)</p><p>Ew divê <strong>nexwe</strong>. (He/She must <strong>not eat</strong>.)</p><p>Tu dikarî <strong>neaxivî</strong>. (You can <strong>not speak</strong>.)</p></div>
        <h3>Examples Table:</h3>
        <table>
            <tr><th>Kurmanji</th><th>English</th></tr>
            <tr><td>Ez <b>di</b>xwazim <b>ne</b>xwim.</td><td>I don't want to eat.</td></tr>
            <tr><td>Ew <b>di</b>kare Kurdî <b>bi</b>nivîse.</td><td>He/She can write Kurdish.</td></tr>
            <tr><td>Divê tu deriyî vekî.</td><td>You must open the door.</td></tr>
            <tr><td>Tu <b>di</b>karî <b>bi</b>çî bazarê?</td><td>Can you go to the market?</td></tr>
            <tr><td>Ew <b>di</b>xwaze <b>ne</b>bêje.</td><td>He/She wants not to say.</td></tr>
            <tr><td>Em <b>di</b>xwazin derkevîn.</td><td>We want to exit.</td></tr>
            <tr><td>Divê tu <b>bi</b>xebitî.</td><td>You must work.</td></tr>
            <tr><td>Ez <b>di</b>karim pirtûkê wergirim.</td><td>I can take the book.</td></tr>
            <tr><td>Ew <b>di</b>vê <b>ne</b>bîne.</td><td>He/She must not see.</td></tr>
            <tr><td>Em <b>di</b>karin <b>bi</b>axivîn.</td><td>We can speak.</td></tr>
        </table>

         <div class="fill-exercise">
             <h3>Exercise 3: Fill in the Subjunctive Verb Form</h3>


             <div class="fill-item" data-correct="biçim">
                 <div class="exercise-row">
                     <span>Ez dixwazim malê</span>
                     <input type="text" class="fill-input" id="fill-subjunctive1" readonly>
                     <span>.</span><span class="verb-hint">(çûn - to go)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">biçim</button>
                     <button class="key-btn">diçim</button>
                     <button class="key-btn">çim</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive1-feedback"></div>
             </div>

             <div class="fill-item" data-correct="biaxivî">
                 <div class="exercise-row">
                     <span>Tu dikarî Kurdî</span>
                     <input type="text" class="fill-input" id="fill-subjunctive2" readonly>
                     <span>?</span><span class="verb-hint">(axaftin - to speak)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">diaxivî</button>
                     <button class="key-btn">biaxivî</button>
                     <button class="key-btn">axivî</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive2-feedback"></div>
             </div>

             <div class="fill-item" data-correct="bê">
                 <div class="exercise-row">
                     <span>Divê ew sibê</span>
                     <input type="text" class="fill-input" id="fill-subjunctive3" readonly>
                     <span>.</span><span class="verb-hint">(hatin - to come)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">tê</button>
                     <button class="key-btn">bê</button>
                     <button class="key-btn">dihat</button> </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive3-feedback"></div>
             </div>

             <div class="fill-item" data-correct="vekin">
                 <div class="exercise-row">
                     <span>Em dixwazin derî</span>
                     <input type="text" class="fill-input" id="fill-subjunctive4" readonly>
                     <span>.</span><span class="verb-hint">(vekirin - to open)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">divekin</button>
                     <button class="key-btn">bivekin</button> <button class="key-btn">vekin</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive4-feedback"></div>
             </div>

             <div class="fill-item" data-correct="nexwim">
                 <div class="exercise-row">
                     <span>Ez dixwazim</span>
                     <input type="text" class="fill-input" id="fill-subjunctive5" readonly>
                     <span>.</span><span class="verb-hint">(xwarin - not to eat)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">nexwim</button>
                     <button class="key-btn">naxwim</button> <button class="key-btn">bixwim</button> </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive5-feedback"></div>
             </div>

              <div class="fill-item" data-correct="wergirin">
                 <div class="exercise-row">
                     <span>Hûn dikarin pirtûkê</span>
                     <input type="text" class="fill-input" id="fill-subjunctive6" readonly>
                     <span>.</span><span class="verb-hint">(wergirtin - to take/receive)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">werdigirin</button> <button class="key-btn">biwergirin</button> <button class="key-btn">wergirin</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive6-feedback"></div>
             </div>

             <div class="fill-item" data-correct="nebêjim">
                 <div class="exercise-row">
                     <span>Divê ez</span>
                     <input type="text" class="fill-input" id="fill-subjunctive7" readonly>
                     <span>.</span><span class="verb-hint">(gotin - not to say)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">nabêjim</button> <button class="key-btn">bibêjim</button> <button class="key-btn">nebêjim</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive7-feedback"></div>
             </div>

             <div class="fill-item" data-correct="bixebitin">
                 <div class="exercise-row">
                     <span>Divê hûn</span>
                     <input type="text" class="fill-input" id="fill-subjunctive8" readonly>
                     <span>.</span><span class="verb-hint">(xebitîn - to work)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">dixebitin</button>
                     <button class="key-btn">bixebitin</button>
                     <button class="key-btn">nexebitin</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive8-feedback"></div>
             </div>

             <div class="fill-item" data-correct="nebin">
                 <div class="exercise-row">
                     <span>Ew dixwazin li vir</span>
                     <input type="text" class="fill-input" id="fill-subjunctive9" readonly>
                     <span>.</span><span class="verb-hint">(bûn - not to be)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">nin</button> <button class="key-btn">nebin</button>
                     <button class="key-btn">bibin</button>
                 </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive9-feedback"></div>
             </div>

             <div class="fill-item" data-correct="derkeve">
                 <div class="exercise-row">
                     <span>Ew dikare</span>
                     <input type="text" class="fill-input" id="fill-subjunctive10" readonly>
                     <span>.</span><span class="verb-hint">(derketin - to go out)</span>
                 </div>
                 <div class="key-container">
                     <button class="key-btn">derkeve</button>
                     <button class="key-btn">diderkeve</button>
                     <button class="key-btn">biderkeve</button> </div>
                 <button class="fill-check" onclick="checkFillAnswer(this)">Check</button>
                 <div class="fill-feedback" id="fill-subjunctive10-feedback"></div>
             </div>

         </div>
         </div>

    <div class="section" id="standard-verbs">
        <h2>4. Standard Kurmanji Verbs</h2>
        <p>Now let's learn some of the most common verbs in Kurmanji Kurdish. Try to find the irregular verbs in the examples!</p>
        <table>
            <tr><th>Verb</th><th>English Translation</th><th>Example</th><th>Translation</th></tr>
            <tr><td><strong>bûn</strong></td><td>to be</td><td>Ez kurd <b>im</b>.</td><td>I <b>am</b> Kurdish.</td></tr>
            <tr><td><strong>çûn</strong></td><td>to go</td><td>Em <b>diçin</b> dibistanê.</td><td>We <b>go</b> to school.</td></tr>
            <tr><td><strong>kirin</strong></td><td>to do, to make</td><td>Ez karê xwe <b>dikim</b>.</td><td>I <b>do</b> my work.</td></tr>
            <tr><td><strong>çêkirin</strong></td><td>to make, to prepare</td><td>Ew xwarinê <b>çêdike</b>.</td><td>She <b>prepares</b> food.</td></tr>
            <tr><td><strong>vekirin</strong></td><td>to open</td><td>Tu derî <b>vedikî</b>.</td><td>You <b>open</b> the door.</td></tr>
            <tr><td><strong>hatin</strong></td><td>to come</td><td>Ew <b>tê</b> malê.</td><td>He <b>comes</b> home.</td></tr>
            <tr><td><strong>gotin</strong></td><td>to say</td><td>Ez <b>dibêjim</b> "spas".</td><td>I <b>say</b> "thank you".</td></tr>
            <tr><td><strong>dîtin</strong></td><td>to see, to find</td><td>Em hev <b>dibînin</b>.</td><td>We <b>see</b> each other.</td></tr>
            <tr><td><strong>kirîn</strong></td><td>to buy</td><td>Tu nan <b>dikirî</b>.</td><td>You <b>buy</b> bread.</td></tr>
            <tr><td><strong>xwendin</strong></td><td>to read, to study</td><td>Ez kitêbê <b>dixwînim</b>.</td><td>I <b>read</b> the book.</td></tr>
            <tr><td><strong>xwarin</strong></td><td>to eat</td><td>Ew sêvê <b>dixwe</b>.</td><td>She <b>eats</b> an apple.</td></tr>
            <tr><td><strong>vexwarin</strong></td><td>to drink</td><td>Tu avê <b>vedixwî</b>.</td><td>You <b>drink</b> water.</td></tr>
            <tr><td><strong>ketin</strong></td><td>to fall</td><td>Ez <b>dikevim</b>.</td><td>I <b>fall</b>.</td></tr>
            <tr><td><strong>derketin</strong></td><td>to go out, to leave</td><td>Em <b>derdikevin</b>.</td><td>We <b>go out</b>.</td></tr>
            <tr><td><strong>raketin</strong></td><td>to sleep</td><td>Ew <b>radikeve</b>.</td><td>He <b>sleeps</b>.</td></tr>
        </table>
         <div class="exercise">
            <h3>Exercise 4: Match the Standard Verbs</h3>
            <div class="matching-game" id="standard-verbs-matching-game">
                 <div class="matching-container">
                     <div class="matching-column">
                         <div class="matching-item-container kurdish-container"> <div class="matching-item kurdish" data-id="1">çûn</div><div class="matching-item kurdish" data-id="2">kirin</div><div class="matching-item kurdish" data-id="3">hatin</div><div class="matching-item kurdish" data-id="4">gotin</div><div class="matching-item kurdish" data-id="5">dîtin</div><div class="matching-item kurdish" data-id="6">xwendin</div><div class="matching-item kurdish" data-id="7">xwarin</div><div class="matching-item kurdish" data-id="8">vexwarin</div><div class="matching-item kurdish" data-id="9">raketin</div><div class="matching-item kurdish" data-id="10">kirîn</div><div class="matching-item kurdish" data-id="11">bûn</div><div class="matching-item kurdish" data-id="12">çêkirin</div><div class="matching-item kurdish" data-id="13">vekirin</div><div class="matching-item kurdish" data-id="14">ketin</div><div class="matching-item kurdish" data-id="15">derketin</div></div>
                     </div>
                     <div class="matching-column">
                          <div class="matching-item-container english-container"> <div class="matching-item english" data-id="1">to go</div><div class="matching-item english" data-id="2">to do/make</div><div class="matching-item english" data-id="3">to come</div><div class="matching-item english" data-id="4">to say</div><div class="matching-item english" data-id="5">to see/find</div><div class="matching-item english" data-id="6">to read/study</div><div class="matching-item english" data-id="7">to eat</div><div class="matching-item english" data-id="8">to drink</div><div class="matching-item english" data-id="9">to sleep</div><div class="matching-item english" data-id="10">to buy</div><div class="matching-item english" data-id="11">to be</div><div class="matching-item english" data-id="12">to make/prepare</div><div class="matching-item english" data-id="13">to open</div><div class="matching-item english" data-id="14">to fall</div><div class="matching-item english" data-id="15">to go out/leave</div></div>
                     </div>
                 </div>
                 <div class="matching-result">
                     <div class="matching-feedback" id="standard-verbs-matching-feedback">Select a Kurdish verb and its English meaning</div>
                     <div class="match-progress" id="standard-verbs-match-progress">Matches: <span class="matches-count">0</span>/15</div>
                 </div>
            </div>
        </div>
        </div>

    <div class="section" id="word-order-game">
        <h2>5. Word Order Game</h2> <p>Put the words in the correct order to make sentences with modal verbs. Click on a word to place it in the solution area. Click a word in the solution area to send it back.</p>
        <div class="word-order-game">
            <div id="sentences-container"></div>
        </div>
    </div>

    <div class="section" id="dialogue">
        <h2>6. Dialogue</h2> <p>Read this dialogue that uses modal verbs and common verbs from this lesson:</p>
        <div class="dialogue-box">
            <div class="dialogue-line"><span class="speaker">Azad:</span> Silav! Tu dikarî alîkariya min bikî?<button class="trans-btn" onclick="toggleTranslation('trans1')">Show translation</button><div id="trans1" class="translation">Hello! Can you help me?</div></div>
            <div class="dialogue-line"><span class="speaker">Zîlan:</span> Erê, ez dikarim. Tu çi dixwazî?<button class="trans-btn" onclick="toggleTranslation('trans2')">Show translation</button><div id="trans2" class="translation">Yes, I can. What do you want?</div></div>
            <div class="dialogue-line"><span class="speaker">Azad:</span> Ez dixwazim Kurdî bixwînim. Tu dikarî min hîn bikî?<button class="trans-btn" onclick="toggleTranslation('trans3')">Show translation</button><div id="trans3" class="translation">I want to read Kurdish. Can you teach me?</div></div>
            <div class="dialogue-line"><span class="speaker">Zîlan:</span> Baş e. Tu dikarî bi min re bixwînî. Divê em dest pê bikin.<button class="trans-btn" onclick="toggleTranslation('trans4')">Show translation</button><div id="trans4" class="translation">Good. You can read with me. We should start.</div></div>
            <div class="dialogue-line"><span class="speaker">Azad:</span> Spas! Tu dikî çi îro? Tu diçî dibistanê?<button class="trans-btn" onclick="toggleTranslation('trans5')">Show translation</button><div id="trans5" class="translation">Thanks! What are you doing today? Are you going to school?</div></div>
            <div class="dialogue-line"><span class="speaker">Zîlan:</span> Erê, divê ez biçim dibistanê. Ez dixebitim li wir.<button class="trans-btn" onclick="toggleTranslation('trans6')">Show translation</button><div id="trans6" class="translation">Yes, I must go to school. I work there.</div></div>
            <div class="dialogue-line"><span class="speaker">Azad:</span> Tu dikarî îro piştî dibistanê werî? Em dikarin bi hev re bixwînin.<button class="trans-btn" onclick="toggleTranslation('trans7')">Show translation</button><div id="trans7" class="translation">Can you come today after school? We can read together.</div></div>
            <div class="dialogue-line"><span class="speaker">Zîlan:</span> Erê, ez dikarim. Divê ez niha biçim, lê ez ê paşê bêm.<button class="trans-btn" onclick="toggleTranslation('trans8')">Show translation</button><div id="trans8" class="translation">Yes, I can. I have to go now, but I'll come later.</div></div>
            <div class="dialogue-line"><span class="speaker">Azad:</span> Baş e. Ez dixwazim çay çêkim jî. Tu çay vedixwî?<button class="trans-btn" onclick="toggleTranslation('trans9')">Show translation</button><div id="trans9" class="translation">Good. I want to make tea too. Do you drink tea?</div></div>
            <div class="dialogue-line"><span class="speaker">Zîlan:</span> Erê, spas! Ta paşê!<button class="trans-btn" onclick="toggleTranslation('trans10')">Show translation</button><div id="trans10" class="translation">Yes, thanks! See you later!</div></div>
        </div>
    </div>
    <div class="section">
        <div class="completion-banner">
            <div class="celebration">🌟 🌟 🌟</div>
            <h2>Pîroz be! Te Waneya 5 qedand!</h2>
            <p>Congratulations! You've completed Lesson 5!</p>
            <div class="celebration">🌟 🌟 🌟</div>
        </div>
    </div>

    <div class="nav-buttons-container">
        <a href="../kl_lessons_en.html" class="nav-button">Back to all lessons</a>
    </div>

    <script>
        // --- Utility Functions ---
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }
        function arraysEqual(a, b) {
            if (a.length !== b.length) return false;
            return a.every((val, index) => val === b[index]);
        }

        // --- Matching Game Logic ---
        function initializeMatchingGame(gameId, totalPairs) {
            const gameElement = document.getElementById(gameId);
            if (!gameElement) { console.error(`Matching game element not found: ${gameId}`); return; }
            const kurdishContainer = gameElement.querySelector('.matching-item-container.kurdish-container');
            const englishContainer = gameElement.querySelector('.matching-item-container.english-container');
            const feedbackElement = gameElement.querySelector('.matching-feedback');
            const matchesCountElement = gameElement.querySelector('.matches-count');

            if (!kurdishContainer || !englishContainer || !feedbackElement || !matchesCountElement) {
                 console.error(`Missing elements within matching game: ${gameId}`); return;
            }

            let selected = { kurdish: null, english: null };
            let matchCount = 0;
            matchesCountElement.textContent = matchCount; // Initialize count display

            // --- SHUFFLING ---
            // Shuffle items within each column to ensure randomization
            const kurdishItems = Array.from(kurdishContainer.children);
            shuffleArray(kurdishItems).forEach(item => kurdishContainer.appendChild(item));

            const englishItems = Array.from(englishContainer.children);
            shuffleArray(englishItems).forEach(item => englishContainer.appendChild(item));
            // --- END SHUFFLING ---

            const items = gameElement.querySelectorAll('.matching-item');

            items.forEach(item => {
                const newItem = item.cloneNode(true); // Clone to remove old listeners
                item.parentNode.replaceChild(newItem, item);

                newItem.addEventListener('click', function() {
                    if (this.classList.contains('matched')) return;
                    const isKurdish = this.classList.contains('kurdish');
                    const side = isKurdish ? 'kurdish' : 'english';

                    if (selected[side]) { selected[side].classList.remove('selected'); }
                    this.classList.add('selected');
                    selected[side] = this;

                    feedbackElement.textContent = '';
                    feedbackElement.className = 'matching-feedback';

                    if (selected.kurdish && selected.english) {
                        if (selected.kurdish.dataset.id === selected.english.dataset.id) {
                            selected.kurdish.classList.remove('selected');
                            selected.english.classList.remove('selected');
                            selected.kurdish.classList.add('matched');
                            selected.english.classList.add('matched');
                            matchCount++;
                            matchesCountElement.textContent = matchCount;
                            feedbackElement.textContent = '✓ Correct!';
                            feedbackElement.classList.add('correct');
                            if (matchCount === totalPairs) { feedbackElement.textContent = '🎉 Well done! All matched!'; }
                            selected = { kurdish: null, english: null };
                        } else {
                            feedbackElement.textContent = '✗ Incorrect. Try again!';
                            feedbackElement.classList.add('incorrect');
                            const selK = selected.kurdish; const selE = selected.english;
                            setTimeout(() => {
                                if(selK) selK.classList.remove('selected');
                                if(selE) selE.classList.remove('selected');
                            }, 800);
                            selected = { kurdish: null, english: null };
                        }
                    }
                });
                 newItem.addEventListener('touchstart', function() { this.style.opacity = '0.7'; });
                 newItem.addEventListener('touchend', function() { this.style.opacity = '1'; });
            });
        }


        // --- Fill-in Exercise Logic (Subjunctive - EXACTLY like Ukrainian Ex 3) ---
        function initializeFillInKeys() {
             // Add click listener to all key buttons within .fill-exercise
             document.querySelectorAll('.fill-exercise .key-btn').forEach(button => {
                 button.addEventListener('click', function() {
                     const fillItem = this.closest('.fill-item'); // Find the parent exercise item
                     if (!fillItem) return;
                     const input = fillItem.querySelector('.fill-input'); // Find the input within that item
                     if (input) {
                         input.value = this.textContent; // Set input value to button text
                         // Clear feedback
                         const feedback = fillItem.querySelector('.fill-feedback');
                         if(feedback) {
                             feedback.textContent = '';
                             feedback.className = 'fill-feedback';
                         }
                         input.style.borderColor = "var(--kurdish-yellow)"; // Reset border
                         input.style.backgroundColor = "#f8f8f8"; // Reset background
                     }
                 });
             });

             // Shuffle keys within each key container
             document.querySelectorAll('.fill-exercise .key-container').forEach(container => {
                const keys = Array.from(container.children);
                shuffleArray(keys).forEach(key => container.appendChild(key));
             });
        }

        function checkFillAnswer(buttonElement) { // Triggered by the check button
            const item = buttonElement.closest('.fill-item');
            if (!item) return;

            const input = item.querySelector('.fill-input');
            const feedback = item.querySelector('.fill-feedback');
            const correctAnswer = item.dataset.correct;
            const userAnswer = input ? input.value : null; // Get value from input

            if (!input || !feedback) {
                 console.error(`Input or feedback element not found for item.`);
                 return;
            }

            // Trim answers for comparison
            const trimmedUserAnswer = userAnswer ? userAnswer.trim() : '';
            const trimmedCorrectAnswer = correctAnswer ? correctAnswer.trim() : '';


            if (trimmedUserAnswer && trimmedUserAnswer === trimmedCorrectAnswer) {
                feedback.textContent = "✓ Correct!";
                feedback.className = "fill-feedback correct";
                input.style.borderColor = "var(--kurdish-green)";
                input.style.backgroundColor = "#e5f0e3"; // Light green background
            } else if (trimmedUserAnswer) {
                feedback.innerHTML = `✗ Incorrect. Correct is: <span class="correct-answer-display">${correctAnswer}</span>`;
                feedback.className = "fill-feedback incorrect";
                input.style.borderColor = "var(--kurdish-red)";
                input.style.backgroundColor = "#fff0f0"; // Light red background
            } else {
                feedback.textContent = "Please select an option by clicking a button.";
                feedback.className = "fill-feedback"; // Neutral feedback
                input.style.borderColor = "var(--kurdish-yellow)";
                input.style.backgroundColor = "#f8f8f8";
            }
        }


        // --- Word Order Game Logic ---
        function initializeWordOrderGame() {
            // --- UPDATED sentencesData with user's corrections ---
            const sentencesData = [
                 { kurdish: "Ez dixwazim biçim malê.", english: "I want to go home.", modalVerbs: ["dixwazim", "biçim"] },
                 { kurdish: "Tu dikarî bi min re bixwînî?", english: "Can you read with me?", modalVerbs: ["dikarî", "bixwînî"] },
                 { kurdish: "Îşev divê ew zû razê.", english: "He/she should sleep early tonight.", modalVerbs: ["divê", "razê"] }, // Corrected order & verb
                 { kurdish: "Em dixwazin xwarinê amade bikin.", english: "We want to prepare (make) food.", modalVerbs: ["dixwazin", "bikin"] }, // Corrected verb phrase, assumed 'Em dixwazin'
                 { kurdish: "Ew dikare Kurdî biaxive.", english: "He/she can speak Kurdish.", modalVerbs: ["dikare", "biaxive"] }, // Capitalization change only
                 { kurdish: "Divê tu derî vekî.", english: "You should open the door.", modalVerbs: ["Divê", "vekî"] }, // No change needed (corrected typo earlier)
                 { kurdish: "Ez dikarim ji te re avê bînim.", english: "I can bring water for you.", modalVerbs: ["dikarim", "bînim"] }, // Corrected order
                 { kurdish: "Tu dixwazî bi me re werî?", english: "Do you want to come with us?", modalVerbs: ["dixwazî", "werî"] } // No change needed
            ];
            // --- END UPDATED sentencesData ---

            const sentences = sentencesData.map(item => ({
                original: item.kurdish,
                english: item.english,
                modalVerbs: item.modalVerbs || [],
                // Generate words array from the (potentially updated) kurdish string
                words: item.kurdish.replace(/[.?]/g, '').split(/\s+/).filter(word => word.length > 0) // Ensure no empty strings
            }));

            const gameContainer = document.getElementById('sentences-container');
            if (!gameContainer) { console.error("Word order game container 'sentences-container' not found."); return; }
            gameContainer.innerHTML = ''; // Clear previous content

            sentences.forEach((sentence, index) => {
                const sentenceElement = document.createElement('div');
                sentenceElement.className = 'game-sentence';
                sentenceElement.id = `sentence-${index}`;
                const translation = document.createElement('div');
                translation.className = 'game-sentence-translation';
                translation.innerHTML = `<span class="sentence-number">${index + 1}/${sentences.length}</span> ${sentence.english}`;
                sentenceElement.appendChild(translation);
                const solutionArea = document.createElement('div');
                solutionArea.className = 'solution-area';
                solutionArea.id = `solution-area-${index}`;
                sentenceElement.appendChild(solutionArea);
                const wordsBank = document.createElement('div');
                wordsBank.className = 'words-bank';
                wordsBank.id = `words-bank-${index}`;
                sentenceElement.appendChild(wordsBank);
                const shuffledWords = shuffleArray(sentence.words); // Shuffle the correct words
                shuffledWords.forEach(word => {
                    const wordElement = document.createElement('div');
                    wordElement.className = 'word-box';
                    wordElement.textContent = word;
                    // Check against the modalVerbs array defined in sentencesData
                    if (sentence.modalVerbs.includes(word)) {
                        wordElement.classList.add('modal');
                    }
                    wordElement.addEventListener('click', () => {
                        const parent = wordElement.parentElement;
                        const targetBank = parent.classList.contains('words-bank') ? solutionArea : wordsBank;
                        targetBank.appendChild(wordElement);
                        const feedbackElement = document.getElementById(`feedback-${index}`);
                        if(feedbackElement) { feedbackElement.textContent = ''; feedbackElement.className = 'game-feedback'; }
                    });
                    wordsBank.appendChild(wordElement);
                });
                const feedback = document.createElement('div');
                feedback.className = 'game-feedback';
                feedback.id = `feedback-${index}`;
                sentenceElement.appendChild(feedback);
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'sentence-buttons';
                const checkButton = document.createElement('button');
                checkButton.className = 'check-btn'; // Use general check-btn style
                checkButton.textContent = 'Check Answer';
                checkButton.onclick = () => checkSentence(index, sentences); // Pass sentences array
                buttonContainer.appendChild(checkButton);
                const showAnswerButton = document.createElement('button');
                showAnswerButton.className = 'show-answer-btn'; // Use specific class if needed, or general
                showAnswerButton.textContent = 'Show Answer';
                showAnswerButton.onclick = () => showAnswer(index, sentences); // Pass sentences array
                buttonContainer.appendChild(showAnswerButton);
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-btn'; // Use specific class if needed, or general
                deleteBtn.textContent = 'Clear Box';
                deleteBtn.onclick = () => {
                    const currentSolutionArea = document.getElementById(`solution-area-${index}`);
                    const currentWordsBank = document.getElementById(`words-bank-${index}`);
                    while (currentSolutionArea.firstChild) { currentWordsBank.appendChild(currentSolutionArea.firstChild); }
                     const feedbackElement = document.getElementById(`feedback-${index}`);
                     if(feedbackElement) { feedbackElement.textContent = ''; feedbackElement.className = 'game-feedback'; }
                };
                buttonContainer.appendChild(deleteBtn);
                sentenceElement.appendChild(buttonContainer);
                gameContainer.appendChild(sentenceElement);
                 if (index > 0) { sentenceElement.style.display = 'none'; }
            });
        }
        function checkSentence(sentenceId, sentences) { // Receive sentences array
            const solutionArea = document.getElementById(`solution-area-${sentenceId}`);
            const feedbackElement = document.getElementById(`feedback-${sentenceId}`);
            const sentenceElement = document.getElementById(`sentence-${sentenceId}`);
            if (!solutionArea || !feedbackElement || !sentenceElement) return;
            const currentWords = Array.from(solutionArea.children).map(word => word.textContent);
            const correctWords = sentences[sentenceId].words; // Get correct words from passed array
            if (currentWords.length !== correctWords.length) {
                feedbackElement.textContent = '✗ Please use all the words.';
                feedbackElement.className = 'game-feedback feedback-incorrect'; return;
            }
            const isCorrect = arraysEqual(currentWords, correctWords);
            if (isCorrect) {
                feedbackElement.textContent = '✓ Correct! Well done!';
                feedbackElement.className = 'game-feedback feedback-correct';
                sentenceElement.classList.add('completed');
                if (sentenceId < sentences.length - 1) {
                    setTimeout(() => {
                        const nextSentence = document.getElementById(`sentence-${sentenceId + 1}`);
                        if (nextSentence) { nextSentence.style.display = 'flex'; nextSentence.scrollIntoView({ behavior: 'smooth', block: 'center' }); }
                    }, 800);
                } else { feedbackElement.textContent = '🎉 You completed the word order game!'; }
            } else {
                feedbackElement.textContent = '✗ Not quite right. Try again!';
                feedbackElement.className = 'game-feedback feedback-incorrect';
            }
        }
        function showAnswer(sentenceId, sentences) { // Receive sentences array
            const solutionArea = document.getElementById(`solution-area-${sentenceId}`);
            const wordsBank = document.getElementById(`words-bank-${sentenceId}`);
            const feedbackElement = document.getElementById(`feedback-${sentenceId}`);
            const sentenceElement = document.getElementById(`sentence-${sentenceId}`);
             if (!solutionArea || !wordsBank || !feedbackElement || !sentenceElement) return;
            solutionArea.innerHTML = ''; wordsBank.innerHTML = '';
            sentences[sentenceId].words.forEach(word => { // Use correct words from passed array
                const wordElement = document.createElement('div');
                wordElement.className = 'word-box'; wordElement.textContent = word;
                 // Check against the modalVerbs array defined in sentencesData
                 if (sentences[sentenceId].modalVerbs.includes(word)) {
                     wordElement.classList.add('modal');
                 }
                wordElement.style.cursor = 'default'; solutionArea.appendChild(wordElement);
            });
            feedbackElement.textContent = 'This is the correct order.';
            feedbackElement.className = 'game-feedback';
            sentenceElement.classList.add('completed');
             if (sentenceId < sentences.length - 1) {
                 setTimeout(() => {
                     const nextSentence = document.getElementById(`sentence-${sentenceId + 1}`);
                     if (nextSentence) { nextSentence.style.display = 'flex'; nextSentence.scrollIntoView({ behavior: 'smooth', block: 'center' }); }
                 }, 800);
             }
        }

        // --- Dialogue Translation Toggle ---
        function toggleTranslation(id) {
            const translation = document.getElementById(id);
            const button = translation.previousElementSibling;
            if (translation && button) {
                if (translation.style.display === 'block') {
                    translation.style.display = 'none'; button.textContent = 'Show translation';
                } else {
                    translation.style.display = 'block'; button.textContent = 'Hide translation';
                }
            }
        }

        // --- Initialization on DOM Load ---
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize all matching games with correct pair counts
            initializeMatchingGame('prepositions-matching-game', 12);
            initializeMatchingGame('modal-verbs-matching-game', 3);
            initializeMatchingGame('standard-verbs-matching-game', 15);

            // Initialize fill-in exercise functionality (keys + Enter) for Ex 3
            initializeFillInKeys();

            // Initialize word order game
            initializeWordOrderGame();
        });

    </script>

</body>
</html>
