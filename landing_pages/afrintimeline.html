<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Corrected paths to JS files -->
    <script src="../afrin_timeline/timelineData.js"></script>
    <script src="../afrin_timeline/timelineColors.js"></script>
    <script src="../afrin_timeline/timelinedata_kurdish.js"></script>
    <script src="../afrin_timeline/timelinedata_arabic.js"></script>
    
    <script>
        console.log('Data files loaded:', {
            timelineData: typeof timelineData !== 'undefined',
            timelineColors: typeof timelineColors !== 'undefined',
            timelineDataKurdish: typeof timelineDataKurdish !== 'undefined',
            timelineDataArabic: typeof timelineDataArabic !== 'undefined'
        });
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historical Timeline of Afrin</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.21.2/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <!-- Corrected path to favicon -->
    <link rel="icon" type="image/gif" href="../other/olive.gif">
    <style>
        html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0f4f8;
        }

        .timeline-container {
            display: grid;
            grid-template-rows: 60px 1fr;  /* Fixed header height */
            height: calc(100vh - 96px); /* Accounts for h1 height + padding */
            overflow: hidden;
            position: relative;  /* Add this */
        }

        .timeline-headers, .timeline-content {
            display: grid;
            grid-template-columns: 80px repeat(6, minmax(0, 1fr));
            width: 100%;
        }

        .timeline-headers, .column-header, .year-header {
            position: sticky;
            top: 0;
            z-index: 10;
            background-color: #FFD700;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            height: 60px;  /* Explicit height */
        }

        .timeline-content {
            overflow-y: auto;
            height: calc(100vh - 156px);  /* Explicit height: viewport - header - padding */
            position: relative;  /* Add this */
        }

        .column-header, .year-header {
            padding: 1rem;
            font-weight: bold;
            text-align: center;
            border-right: 1px solid #e2e8f0;
            border-bottom: 2px solid #e2e8f0;
            box-sizing: border-box;
        }

        .year-column, .timeline-column {
            border-right: 1px solid #e2e8f0;
            box-sizing: border-box;
            height: 100%;  /* Full height */
            position: relative;  /* Add this */
        }

        .year-column {
            border-right: 1px solid #e2e8f0;
            box-sizing: border-box;
            height: 100%;  /* Full height */
            position: relative;  /* Add this */
        }
        .year-marker {
            padding: 0.5rem;
            border-bottom: 1px solid #e2e8f0;
            height: 40px;
            font-weight: bold;
            color: #4a5568;
            background-color: #fff4c7;
        }
        .timeline-item {
            padding: 0.5rem;
            border-bottom: 1px solid #e2e8f0;
            height: 40px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
            text-align: left;
        }
        .hoverable-item:hover {
            height: auto;
            min-height: 40px;
            transform: scale(1.02);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .auto-size-text {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
        }
        .date-text {
            text-align: left;
            align-self: flex-start;
            padding-left: 0.25rem;
        }
        .hover-image {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            transition: opacity 0.3s ease-in-out;
        }

        /* Mobile warning styling */
        .mobile-warning {
            display: none;
            height: 100vh;
            width: 100vw;
            position: fixed;
            top: 0;
            left: 0;
            background-color: #c7c8d1;
            z-index: 9999;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Prevent scrolling */
        }

        .mobile-warning-content {
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 2rem;
            margin: 0;
            background: none;
            box-shadow: none;
        }

        .warning-text {
            margin-bottom: 2rem;
            font-size: 1.2rem;
            line-height: 1.5;
            text-align: center;
        }

        .arabic-text {
            font-size: 1.4rem;
            direction: rtl;
        }


        /* Nav banner - always on top */
        .nav-banner {
            width: 100%;
            height: 40px;
            background-color: #d4b642;
            display: flex;
            align-items: center;
            padding: 0 20px;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 10000;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            transition: opacity 0.2s ease;
        }

        .nav-link:hover {
            opacity: 0.8;
        }

        /* Mobile warning styling */
        .mobile-warning {
            display: none;
            height: 100vh;
            width: 100vw;
            position: fixed;
            top: 0;
            left: 0;
            background-color: #c7c8d1;
            z-index: 9999;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Prevent scrolling */
        }

        .mobile-warning-content {
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding: 2rem;
            margin: 0;
            background: none;
            box-shadow: none;
            padding-top: 0px; /* Space for banner */
        }

        /* Mobile responsiveness adjustments */
        
        @media screen and (max-width: 768px) {
            .mobile-warning {
                display: flex;
            }
            
            .timeline-container {
                display: none;
            }

            body {
                position: fixed;
                width: 100vw;
                height: 100vh;
                overflow: hidden;
            }
        }
    </style>
</head>
<body>
    <!-- Added nav banner -->
    <nav class="nav-banner">
        <a href="https://www.zachariahhopkins.com" target="_blank" rel="noopener noreferrer" class="nav-link">
            Created by Zachariah Hopkins
        </a>
    </nav>

    <div class="mobile-warning">
        <div class="mobile-warning-content">
            <div class="warning-text">
                The Historical Timeline of Afrin cannot be viewed on a mobile device.<br>
                Please view the Historical Timeline of Afrin on a computer screen.
            </div>

            <div class="warning-text">
                Kronolojiya Dîrokî ya Efrînê bi amûra mobîl nayê dîtin.<br>
                Ji kerema xwe Kronolojiya Dîrokî ya Efrînê li ser ekrana komputerê temaşe bikin.
            </div>

            <div class="warning-text arabic-text">
                لا يمكن عرض الجدول الزمني التاريخي لعفرين على جهاز محمول.<br>
                يرجى عرض الجدول الزمني التاريخي لعفرين على شاشة الكمبيوتر.
            </div>
        </div>
    </div>
    <div id="root" style="margin-top: 40px"></div>

    <style>
        /* Reset default margins */
        body {
            margin: 0;
            padding: 0;
        }
        
        /* Nav banner styling */
        .nav-banner {
            width: 100%;
            height: 40px;
            background-color: #d4b642;
            display: flex;
            align-items: center;
            padding: 0 20px;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1001; /* Increased z-index to show above mobile warning */
        }
        .nav-link {
            color: white;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            transition: opacity 0.2s ease;
        }
        .nav-link:hover {
            opacity: 0.8;
        }
        /* Mobile responsiveness - show banner on mobile */
        @media (max-width: 768px) {
            .nav-banner {
                position: absolute;
                height: 50px;
                padding: 0 15px;
                /* Ensure banner is visible at top of warning screen */
                background-color: #292f36;
                z-index: 10000;
            }
            .nav-link {
                font-size: 1rem;
            }
            /* Adjust mobile warning top padding to account for banner */
            .mobile-warning-content {
                padding-top: 70px;
            }
        }
        

    </style>

    <script type="text/babel">

        

        const YearColumn = ({ startYear, endYear, decadeMap }) => {
            const years = [];
            
            for (let year = startYear; year <= endYear; year += 10) {
                const rowsNeeded = decadeMap[year] || 1;
                const displayYear = year < 0 ? `${Math.abs(year)} BCE` : `${year}`;
                
                // Create as many rows as the decade map indicates
                for (let i = 0; i < rowsNeeded; i++) {
                    // Keep the darker background for duplicates but make base color #fff4c7
                    const backgroundColor = i === 0 ? '#e8d4b0' : '#e2e2e2';
                    
                    years.push(
                        <div 
                            key={`${year}-${i}`} 
                            className="year-marker"
                            style={{ 
                                backgroundColor,
                                color: i === 0 ? '#000000' : '#404040' // Slightly darker text for duplicate rows
                            }}
                        >
                            {displayYear}
                        </div>
                    );
                }
            }
            
            return (
                <div className="year-column">
                    {years}
                </div>
            );
        };

        const AutoSizeText = ({ text, className, isBold, isMainEvent, isHovered }) => {
            const containerRef = React.useRef(null);
            const textRef = React.useRef(null);
            const [fontSize, setFontSize] = React.useState(16);

            React.useEffect(() => {
                const resizeText = () => {
                    if (containerRef.current && textRef.current) {
                        const containerWidth = containerRef.current.offsetWidth;
                        const containerHeight = containerRef.current.offsetHeight;
                        let currentFontSize = fontSize;

                        if (isMainEvent && !isHovered) {
                            textRef.current.style.whiteSpace = 'nowrap';
                            while (textRef.current.offsetWidth > containerWidth || textRef.current.offsetHeight > containerHeight) {
                                currentFontSize--;
                                textRef.current.style.fontSize = `${currentFontSize}px`;
                            }
                        } else {
                            textRef.current.style.whiteSpace = 'normal';
                            while (textRef.current.offsetWidth > containerWidth || textRef.current.offsetHeight > containerHeight) {
                                currentFontSize--;
                                setFontSize(currentFontSize);
                            }

                            while (textRef.current.offsetWidth < containerWidth && textRef.current.offsetHeight < containerHeight && currentFontSize < 16) {
                                currentFontSize++;
                                setFontSize(currentFontSize);
                            }
                        }

                        setFontSize(currentFontSize);
                    }
                };

                resizeText();
                window.addEventListener('resize', resizeText);
                return () => window.removeEventListener('resize', resizeText);
            }, [text, isMainEvent, isHovered]);

            return (
                <div ref={containerRef} className={`auto-size-text ${className}`}>
                    <span 
                        ref={textRef} 
                        style={{ 
                            fontSize: `${fontSize}px`, 
                            fontWeight: isBold ? 'bold' : 'normal',
                            whiteSpace: isMainEvent && !isHovered ? 'nowrap' : 'normal',
                            overflow: isMainEvent && !isHovered ? 'hidden' : 'visible',
                            textOverflow: isMainEvent && !isHovered ? 'ellipsis' : 'clip',
                            width: '100%'
                        }}
                    >
                        {text}
                    </span>
                </div>
            );
        };

        const TimelineItem = ({ date, mainEvent, additionalInfo, source, verification, color, onHover, columnTitle, decadeYear }) => {
            const [isClicked, setIsClicked] = React.useState(false);
            const itemRef = React.useRef(null);

            React.useEffect(() => {
                const handleClickOutside = (event) => {
                    if (itemRef.current && !itemRef.current.contains(event.target)) {
                        setIsClicked(false);
                        onHover(false, "", "");  // Clear the hover state
                    }
                };

                const handleScroll = () => {
                    setIsClicked(false);
                    onHover(false, "", "");  // Clear the hover state
                };

                // Only add listeners if the item is clicked
                if (isClicked) {
                    document.addEventListener('mousedown', handleClickOutside);
                    document.addEventListener('scroll', handleScroll, true);

                    return () => {
                        document.removeEventListener('mousedown', handleClickOutside);
                        document.removeEventListener('scroll', handleScroll, true);
                    };
                }
            }, [isClicked, onHover]);

            const handleClick = () => {
                if (columnTitle !== "Historical Eras") {
                    const newClickState = !isClicked;
                    setIsClicked(newClickState);
                    onHover(newClickState, date, columnTitle);
                }
            };

            const backgroundColor = React.useMemo(() => {
                if (columnTitle === "Afrin Under" && mainEvent === "Akkadian Empire") {
                    return "#E6C588";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "New Kingdom Egypt") {
                    return "#F2DD7B";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Middle Assyrian Period") {
                    return "#A13939";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Neo Assyrian Empire") {
                    return "#C85F5F";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Neo Babylonian Empire") {
                    return "#6483D1";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Achaemenid Empire") {
                    return "#FFBE7D";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Macedonian Empire") {
                    return "#A8C7E5";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Ptolemaic Egypt") {
                    return "#A8C7E5";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Seceucid Empire") {
                    return "#A8C7E5";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Romans") {
                    return "#EC5800";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Palmyrene Empire") {
                    return "#FFD700";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Rashidun Caliphate") {
                    return "#2E5947";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Umayyad Caliphate") {
                    return "#2E5947";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Abassid Caliphate") {
                    return "#427B63";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Ikhshidids") {
                    return "#64BF99";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Seljuk Empire") {
                    return "#E6C588";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Ayyubid Sultanate") {
                    return "#86F4C3";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Mameluk Sultanate") {
                    return "#8B6B45";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Timurid Empire") {
                    return "#B87333";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Ottoman Empire") {
                    return "#EC5800";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "French Protectorate") {
                    return "#29b6f6";
                }
                if (columnTitle === "Afrin Under" && mainEvent === "Egypt (Muhammad Ali Pasha Dynasty)") {
                    return "#E97451";
                }

                if (columnTitle === "Egypt" || columnTitle === "Misir" || columnTitle === "مصر") {
                    const year = decadeYear;
                    return getEgyptianEraColor(`${year}`) || color;
                } else if (columnTitle === "Mesopotamia/Iran" || columnTitle === "Mezopotamya/Îran" || columnTitle === "بلاد ما بين النهرين/إيران") {
                    const year = decadeYear;
                    return getIranianEraColor(`${year}`) || color;

                } else if (columnTitle === "Climate in Afrin") { // Or whatever you name the column
        const year = decadeYear;
        return getClimateEraColor(`${year}`) || color; // This calls your new function
    
                } else if (columnTitle === "Historical Eras") {
                    const dateStr = date || "0 CE";
                    const yearMatch = dateStr.match(/-?\d+/);
                    if (!yearMatch) return color;
                    
                    const year = parseInt(yearMatch[0]);
                    return getHistoricalEraColor(`${year}`) || color;
                }
                
                return color;
            }, [columnTitle, date, color, decadeYear, mainEvent]);

            const className = `timeline-item${columnTitle !== "Historical Eras" ? " hoverable-item" : ""}`;

            return (
                <div 
                    ref={itemRef}
                    className={className}
                    style={{ 
                        backgroundColor: backgroundColor || color,
                        cursor: columnTitle !== "Historical Eras" ? 'pointer' : 'default'
                    }}
                    onClick={handleClick}
                >
                    <AutoSizeText text={date} className="date-text" />
                    <AutoSizeText text={mainEvent} isBold={true} isMainEvent={true} isHovered={isClicked} />
                    {isClicked && additionalInfo && (
                        <AutoSizeText 
                            text={additionalInfo} 
                            className="mt-1" 
                        />
                    )}
                    {isClicked && source && (
                        <div style={{
                            marginTop: '2em',
                            fontSize: '0.75em',
                            fontStyle: 'italic',
                            color: '#666666'
                        }}>
                            {source}
                        </div>
                    )}
                    {isClicked && verification && (
                        <div style={{
                            fontSize: '0.75em',
                            fontStyle: 'italic',
                            color: '#666666'
                        }}>
                            {verification}
                        </div>
                    )}
                </div>
            );
        };

        const TimelineColumn = ({ events, color, startYear, endYear, decadeMap, onHover, title }) => {
            const items = [];
            
            const getDarkerShade = (baseColor, index) => {
                const cappedIndex = Math.min(index, 7);
                const hex = baseColor.replace('#', '');
                const r = parseInt(hex.substring(0, 2), 16);
                const g = parseInt(hex.substring(2, 4), 16);
                const b = parseInt(hex.substring(4, 6), 16);
                const darkenAmount = 0.95 ** cappedIndex;
                const newR = Math.floor(r * darkenAmount).toString(16).padStart(2, '0');
                const newG = Math.floor(g * darkenAmount).toString(16).padStart(2, '0');
                const newB = Math.floor(b * darkenAmount).toString(16).padStart(2, '0');
                return `#${newR}${newG}${newB}`;
            };

            for (let year = startYear; year <= endYear; year += 10) {
                if (title === "Historical Eras") {
                    const activeEvents = events.filter(e => {
                        const startDateMatch = e.startDate.match(/-?\d+/);
                        const endDateMatch = e.endDate ? e.endDate.match(/-?\d+/) : null;
                        const eventStartYear = startDateMatch ? parseInt(startDateMatch[0]) : 0;
                        const eventEndYear = endDateMatch ? parseInt(endDateMatch[0]) : eventStartYear;
                        return eventStartYear <= year && eventEndYear >= year;
                    });

                    const event = activeEvents[0];
                    const rowsNeeded = decadeMap[year] || 1;

                    for (let i = 0; i < rowsNeeded; i++) {
                        if (event) {
                            const dateDisplay = event.endDate 
                                ? `${event.startDate} to ${event.endDate}`
                                : event.startDate;
                            
                            items.push(
                                <TimelineItem
                                    key={`${title}-${year}-${i}`}
                                    date={dateDisplay}
                                    mainEvent={event.mainEvent}
                                    additionalInfo={event.additionalInfo}
                                    source={event.source}
                                    verification={event.verification}
                                    color={getDarkerShade(color, i)}
                                    onHover={(isHovered) => onHover(isHovered, dateDisplay, title)}
                                    columnTitle={title}
                                    decadeYear={year}
                                />
                            );
                        } else {
                            items.push(
                                <TimelineItem
                                    key={`empty-${year}-${i}`}
                                    date=""
                                    mainEvent=""
                                    color={getDarkerShade(color, i)}
                                    onHover={() => {}}
                                    columnTitle={title}
                                    decadeYear={year}
                                />
                            );
                        }
                    }
                } else {
                    const eventsInDecade = events.filter(e => {
                        const startYear = parseInt(e.startDate.match(/-?\d+/)[0]);
                        return startYear >= year && startYear < year + 10;
                    }).sort((a, b) => parseInt(a.startDate.match(/-?\d+/)[0]) - parseInt(b.startDate.match(/-?\d+/)[0]));

                    const rowsNeeded = decadeMap[year] || 1;

                    if (title === "Afrin Under") {
                        const activeEvents = events.filter(e => {
                            const startDateMatch = e.startDate.match(/-?\d+/);
                            const endDateMatch = e.endDate ? e.endDate.match(/-?\d+/) : null;
                            const eventStartYear = startDateMatch ? parseInt(startDateMatch[0]) : 0;
                            const eventEndYear = endDateMatch ? parseInt(endDateMatch[0]) : eventStartYear;
                            return eventStartYear <= year && eventEndYear >= year;
                        });

                        const event = activeEvents[0];
                        
                        for (let i = 0; i < rowsNeeded; i++) {
                            if (event) {
                                const dateDisplay = event.endDate 
                                    ? `${event.startDate} to ${event.endDate}`
                                    : event.startDate;
                                
                                items.push(
                                    <TimelineItem
                                        key={`${title}-${year}-${i}`}
                                        date={dateDisplay}
                                        mainEvent={event.mainEvent}
                                        additionalInfo={event.additionalInfo}
                                        source={event.source}
                                        verification={event.verification}
                                        color={getDarkerShade(color, i)}
                                        onHover={(isHovered) => onHover(isHovered, dateDisplay, title)}
                                        columnTitle={title}
                                        decadeYear={year}
                                    />
                                );
                            } else {
                                items.push(
                                    <TimelineItem
                                        key={`empty-${year}-${i}`}
                                        date=""
                                        mainEvent=""
                                        color={getDarkerShade(color, i)}
                                        onHover={() => {}}
                                        columnTitle={title}
                                        decadeYear={year}
                                    />
                                );
                            }
                        }
                    } else {
                        for (let i = 0; i < rowsNeeded; i++) {
                            if (i < eventsInDecade.length) {
                                const event = eventsInDecade[i];
                                const dateDisplay = event.endDate 
                                    ? `${event.startDate} to ${event.endDate}`
                                    : event.startDate;

                                items.push(
                                    <TimelineItem
                                        key={`${event.startDate}-${event.endDate || ''}-${i}`}
                                        date={dateDisplay}
                                        mainEvent={event.mainEvent}
                                        additionalInfo={event.additionalInfo}
                                        source={event.source}
                                        verification={event.verification}
                                        color={getDarkerShade(color, i)}
                                        onHover={(isHovered) => onHover(isHovered, dateDisplay, title)}
                                        columnTitle={title}
                                        decadeYear={year}
                                    />
                                );
                            } else {
                                items.push(
                                    <TimelineItem
                                        key={`empty-${year}-${i}`}
                                        date=""
                                        mainEvent=""
                                        color={getDarkerShade(color, i)}
                                        onHover={() => {}}
                                        columnTitle={title}
                                        decadeYear={year}
                                    />
                                );
                            }
                        }
                    }
                }
            }
            
            return (
                <div className="timeline-column">
                    {items}
                </div>
            );
        };

        const HoverImage = ({ show, date = "", columnTitle = "", onHover }) => {
            const [showTooltip1, setShowTooltip1] = React.useState(false);
            const [showTooltip2, setShowTooltip2] = React.useState(false);
            const containerRef = React.useRef(null);

            React.useEffect(() => {
                const handleClickOutside = (event) => {
                    if (containerRef.current && !containerRef.current.contains(event.target)) {
                        setShowTooltip1(false);
                        setShowTooltip2(false);
                        onHover(false, "", "");
                    }
                };

                const handleScroll = () => {
                    setShowTooltip1(false);
                    setShowTooltip2(false);
                    onHover(false, "", "");
                };

                if (show) {
                    document.addEventListener('mousedown', handleClickOutside);
                    document.addEventListener('scroll', handleScroll, true);
                    return () => {
                        document.removeEventListener('mousedown', handleClickOutside);
                        document.removeEventListener('scroll', handleScroll, true);
                    };
                }
            }, [show, onHover]);

            const availableYears = [
                -2500, -2400, -2300, -2200, -2100, -2000, -1950, -1850, -1800, -1750,
                -1700, -1650, -1600, -1550, -1500, -1450, -1400, -1350, -1300, -1250,
                -1200, -1100, -1050, -1000, -990, -980, -970, -960, -950, -940, -930,
                -920, -910, -900, -890, -880, -870, -860, -850, -840, -830, -820, -810,
                -800, -790, -780, -770, -760, -750, -740, -730, -720, -710, -700, -690,
                -680, -670, -660, -650, -640, -630, -620, -610, -600, -590, -580, -570,
                -560, -550, -540, -530, -520, -510, -500, -490, -480, -410, -400, -390,
                -380, -370, -360, -350, -340, -330, -320, -310, -300, -290, -280, -270,
                -260, -250, -230, -220, -210, -200, -190, -180, -170, -160, -150, -140,
                -130, -120, -110, -100, -90, -80, -70, -60, -50, -40, -30, -20, -10, 0,
                10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160,
                170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300,
                310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440,
                450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570, 580,
                590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720,
                730, 740, 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860,
                870, 880, 890, 900, 910, 920, 930, 940, 950, 960, 970, 980, 990, 1000,
                1010, 1020, 1030, 1040, 1050, 1060, 1070, 1080, 1090, 1100, 1110, 1120,
                1130, 1140, 1150, 1160, 1170, 1180, 1190, 1200, 1210, 1220, 1230, 1240,
                1250, 1260, 1270, 1280, 1290, 1300, 1310, 1320, 1330, 1340, 1350, 1360,
                1370, 1380, 1390, 1400, 1410, 1420, 1430, 1440, 1450, 1460, 1470, 1480,
                1490, 1500, 1510, 1520, 1530, 1550, 1560, 1570, 1580, 1590, 1600, 1610,
                1620, 1630, 1650, 1660, 1670, 1680, 1690, 1700, 1710, 1720, 1730, 1740,
                1750, 1760, 1770, 1780, 1790, 1800, 1810, 1820, 1830, 1840, 1850, 1860,
                1870, 1880, 1890, 1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980,
                1990, 2000, 2010, 2020
            ];

            const getImagePath = (date, isAfrin = false) => {
                const yearMatch = date.match(/-?\d+/);
                if (!yearMatch) return "";
                
                const year = parseInt(yearMatch[0]);
                
                // Return empty string if year is before -2500
                if (year < -2500) return "";
                
                const nearestYear = availableYears.reduce((nearest, current) => {
                    return Math.abs(current - year) < Math.abs(nearest - year) ? current : nearest;
                }, availableYears[0]);
                
                const absYear = Math.abs(nearestYear);
                let formattedYear;
                if (absYear < 10) {
                    formattedYear = `00${absYear}`;
                } else if (absYear < 100) {
                    formattedYear = `0${absYear}`;
                } else {
                    formattedYear = `${absYear}`;
                }
                
                // *** PATH CORRECTION ***
                const basePath = '../afrin_timeline/images/';

                if (nearestYear < 0) {
                    return isAfrin 
                        ? `${basePath}all_years_afrin/afrin_full_map_BCE${formattedYear}.jpg`
                        : `${basePath}all_years_fullmap/full_map_BCE${formattedYear}.jpg`;
                } else {
                    return isAfrin 
                        ? `${basePath}all_years_afrin/afrin_full_map_${formattedYear}.jpg`
                        : `${basePath}all_years_fullmap/full_map_${formattedYear}.jpg`;
                }
            };

            const imagePath = getImagePath(date);
            const afrinImagePath = getImagePath(date, true);

            // If both image paths are empty, don't show the hover image
            if (!imagePath && !afrinImagePath) {
                return null;
            }

            const rightSideColumns = ["Afrin-Specific Events", "Regional", "Afrin Under"];
            const position = rightSideColumns.includes(columnTitle) ? 'right' : 'left';

            const style = {
                opacity: show ? 1 : 0,
                pointerEvents: show ? 'auto' : 'none',
                position: 'fixed',
                top: '10px',
                width: '500px',
                height: '600px',
                zIndex: 1000,
                transition: 'opacity 0.3s ease-in-out',
                overflow: 'hidden',
                display: 'flex',
                flexDirection: 'column'
            };

            style[position] = '10px';

            const infoIconStyle = {
                position: 'absolute',
                bottom: '10px',
                right: '10px',
                backgroundColor: 'rgba(0, 0, 0, 0.6)',
                color: 'white',
                width: '24px',
                height: '24px',
                borderRadius: '50%',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                cursor: 'pointer',
                fontSize: '14px',
                fontWeight: 'bold',
                zIndex: 1001
            };

            const tooltipStyle = {
                position: 'absolute',
                bottom: '40px',
                right: '10px',
                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                color: 'white',
                padding: '8px 12px',
                borderRadius: '4px',
                fontSize: '14px',
                maxWidth: '200px',
                zIndex: 1002
            };

            return (
                <div ref={containerRef} className="hover-image" style={style}>
                    <div style={{
                        width: '100%',
                        height: '50%',
                        overflow: 'hidden',
                        position: 'relative'
                    }}>
                        <img
                            src={imagePath}
                            alt="Full map"
                            style={{
                                position: 'absolute',
                                width: '100%',
                                height: '100%',
                                objectFit: 'contain',
                                objectPosition: 'center'
                            }}
                        />
                        <div 
                            style={infoIconStyle}
                            onMouseEnter={() => !showTooltip1 && setShowTooltip1(true)}
                            onMouseLeave={() => setShowTooltip1(false)}
                            onClick={() => setShowTooltip1(!showTooltip1)}
                        >
                            i
                        </div>
                        {showTooltip1 && (
                            <div style={tooltipStyle}>
                                Courtesy of <a href="https://www.youtube.com/watch?v=5eIADs7Ct-Q" target="_blank" rel="noopener noreferrer" style={{color: '#3b82f6'}}>@emperorTigerstar</a>
                            </div>
                        )}
                    </div>
                    <div style={{
                        width: '100%',
                        height: '50%',
                        overflow: 'hidden',
                        position: 'relative'
                    }}>
                        <img
                            src={afrinImagePath}
                            alt="Afrin map"
                            style={{
                                position: 'absolute',
                                width: '100%',
                                height: '100%',
                                objectFit: 'contain',
                                objectPosition: position
                            }}
                        />
                        <div 
                            style={infoIconStyle}
                            onMouseEnter={() => !showTooltip1 && setShowTooltip2(true)}
                            onMouseLeave={() => setShowTooltip2(false)}
                            onClick={() => setShowTooltip2(!showTooltip2)}
                        >
                            i
                        </div>
                        {showTooltip2 && (
                            <div style={tooltipStyle}>
                                Courtesy of <a href="https://www.youtube.com/watch?v=5eIADs7Ct-Q" target="_blank" rel="noopener noreferrer" style={{color: '#3b82f6'}}>@emperorTigerstar</a>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const buildDecadeMap = (columns, startYear, endYear) => {
            const decadeMap = {};
            
            // Initialize map for each decade
            for (let year = startYear; year <= endYear; year += 10) {
                decadeMap[year] = 1; // Start with at least 1 row
            }
            
            // For each column
            columns.forEach(column => {
                // Skip Historical Eras as they don't create duplicate rows
                if (column.title === "Historical Eras") return;
                
                // Check each decade
                for (let year = startYear; year <= endYear; year += 10) {
                    // Count events starting in this decade
                    const eventsInDecade = column.events.filter(event => {
                        const startYear = parseInt(event.startDate.match(/-?\d+/)[0]);
                        return startYear >= year && startYear < year + 10;
                    }).length;
                    
                    // Update maximum rows needed for this decade
                    if (eventsInDecade > decadeMap[year]) {
                        decadeMap[year] = eventsInDecade;
                    }
                }
            });
            
            return decadeMap;
        };

        const Timeline = ({ columns, startYear, endYear }) => {
            const headerRef = React.useRef(null);
            const contentRef = React.useRef(null);
            const [showImage, setShowImage] = React.useState(false);
            const [hoveredDate, setHoveredDate] = React.useState("");
            const [hoveredColumn, setHoveredColumn] = React.useState("");
            const [isKurdish, setIsKurdish] = React.useState(false);

            // Calculate decade map once when component mounts or columns change
            const decadeMap = React.useMemo(() => {
                return buildDecadeMap(columns, startYear, endYear);
            }, [columns, startYear, endYear]);

            React.useEffect(() => {
                const adjustHeaderWidth = () => {
                    if (headerRef.current && contentRef.current) {
                        const scrollbarWidth = contentRef.current.offsetWidth - contentRef.current.clientWidth;
                        headerRef.current.style.width = `calc(100% - ${scrollbarWidth}px)`;
                    }
                };

                adjustHeaderWidth();
                window.addEventListener('resize', adjustHeaderWidth);
                
                // Add click handler for Kurdish button
                const kurdishButton = document.querySelector('button');
                if (kurdishButton) {
                    kurdishButton.addEventListener('click', () => setIsKurdish(!isKurdish));
                }
                
                return () => {
                    window.removeEventListener('resize', adjustHeaderWidth);
                    if (kurdishButton) {
                        kurdishButton.removeEventListener('click', () => setIsKurdish(!isKurdish));
                    }
                };
            }, [isKurdish]);

            const handleHover = (isHovered, date, columnTitle) => {
                setShowImage(isHovered);
                setHoveredDate(date);
                setHoveredColumn(columnTitle);
            };

            return (
                <div className="timeline-container">
                    <div ref={headerRef} className="timeline-headers">
                        <div className="year-header">Year</div>
                        {columns.map((column, index) => (
                            <div key={index} className="column-header">
                                {column.title === "Egypt" && isKurdish ? "Misir" :
                                column.title === "Mesopotamia/Iran" && isKurdish ? "Mezopotamya/Îran" :
                                column.title === "Afrin Under" && isKurdish ? "Birêvebirina Efrînê" :
                                column.title}
                            </div>
                        ))}
                    </div>
                    <div ref={contentRef} className="timeline-content">
                        <YearColumn 
                            startYear={startYear} 
                            endYear={endYear}
                            decadeMap={decadeMap}
                        />
                        {columns.map((column, index) => (
                            <TimelineColumn
                                key={index}
                                events={column.events}
                                color={column.color}
                                startYear={startYear}
                                endYear={endYear}
                                decadeMap={decadeMap}
                                onHover={handleHover}
                                title={column.title}
                            />
                        ))}
                    </div>
                    <HoverImage 
                        show={showImage} 
                        date={hoveredDate} 
                        columnTitle={hoveredColumn}
                        onHover={handleHover}
                    />
                </div>
            );
        };


        const App = () => {
            // Initialize state with English data
            const [currentLanguage, setCurrentLanguage] = React.useState('english');
            const [currentData, setCurrentData] = React.useState(timelineData);
            const { startYear, endYear, columns } = currentData;
            const [matchCount, setMatchCount] = React.useState(0);
            const [currentMatch, setCurrentMatch] = React.useState(0);
            const [matches, setMatches] = React.useState([]);
            const [yearMatchCount, setYearMatchCount] = React.useState(0);
            const [currentYearMatch, setCurrentYearMatch] = React.useState(0);
            const [yearMatches, setYearMatches] = React.useState([]);
            const [isBCE, setIsBCE] = React.useState(false);
            const [searchResults, setSearchResults] = React.useState([]);
            const searchResultsRef = React.useRef(null);

            // Effect to handle data switching
            React.useEffect(() => {
                try {
                    let newData;
                    switch(currentLanguage) {
                        case 'kurdish':
                            newData = timelineDataKurdish;
                            break;
                        case 'arabic':
                            newData = timelineDataArabic;
                            break;
                        default:
                            newData = timelineData;
                    }
                    
                    if (newData) {
                        setCurrentData(newData);
                    } else {
                        console.error(`${currentLanguage} timeline data not found`);
                    }
                } catch (error) {
                    console.error('Error switching timeline data:', error);
                }
            }, [currentLanguage]);

            // Rest of the component remains the same
            React.useEffect(() => {
                const handleClickOutside = (event) => {
                    if (searchResultsRef.current && !searchResultsRef.current.contains(event.target)) {
                        setSearchResults([]);
                    }
                };

                document.addEventListener('mousedown', handleClickOutside);
                return () => document.removeEventListener('mousedown', handleClickOutside);
            }, []);

            const findSentenceWithTerm = (text, term) => {
                const sentences = text.split(/[.!?]+/);
                return sentences.find(sentence => 
                    sentence.toLowerCase().includes(term.toLowerCase())
                );
            };

            const findMatches = (isYearSearch = false) => {
                if (!isYearSearch) {
                    const searchText = document.getElementById('searchInput').value.toLowerCase();
                    if (!searchText) {
                        setMatchCount(0);
                        setCurrentMatch(0);
                        setMatches([]);
                        setSearchResults([]);
                        return;
                    }

                    const timelineContent = document.querySelector('.timeline-content');
                    const timelineItems = timelineContent.querySelectorAll('.timeline-item');
                    const newMatches = [];
                    const newResults = [];
                    
                    // Get all timeline data
                    const allColumns = columns.flatMap(column => 
                        column.events.map(event => ({
                            element: null,
                            date: event.startDate + (event.endDate ? ` to ${event.endDate}` : ''),
                            mainEvent: event.mainEvent,
                            additionalInfo: event.additionalInfo,
                        }))
                    );

                    timelineItems.forEach((item) => {
                        const itemText = item.textContent.toLowerCase();
                        const matchingData = allColumns.find(col => 
                            col.mainEvent && itemText.includes(col.mainEvent.toLowerCase())
                        );

                        if (matchingData) {
                            matchingData.element = item;
                            
                            const mainEventText = matchingData.mainEvent || '';
                            const additionalInfoText = matchingData.additionalInfo || '';
                            
                            const mainEventWords = mainEventText.toLowerCase().split(/\s+/);
                            const additionalInfoWords = additionalInfoText.toLowerCase().split(/\s+/);
                            
                            if (mainEventWords.some(word => word === searchText || word.startsWith(searchText)) ||
                                additionalInfoWords.some(word => word === searchText || word.startsWith(searchText))) {
                                
                                newMatches.push(item);
                                
                                let resultText = `${matchingData.date} **${mainEventText}**`;
                                if (additionalInfoText) {
                                    resultText += `. ${additionalInfoText}`;
                                }

                                newResults.push({
                                    sentence: resultText,
                                    element: item
                                });
                            }
                        }
                    });

                    setMatches(newMatches);
                    setMatchCount(newMatches.length);
                    setSearchResults(newResults);
                    if (newMatches.length > 0) {
                        setCurrentMatch(1);
                        highlightMatch(newMatches[0]);
                    }
                    return;
                }

                // Year search functionality
                const yearInput = document.getElementById('yearSearchInput').value;
                if (!yearInput) {
                    setYearMatchCount(0);
                    setCurrentYearMatch(0);
                    setYearMatches([]);
                    return;
                }

                const searchYear = isBCE ? -Math.abs(parseInt(yearInput)) : Math.abs(parseInt(yearInput));
                
                const absYear = Math.abs(searchYear);
                const remainder = absYear % 10;
                const roundedAbsYear = remainder >= 5 ? 
                    absYear - remainder + 10 : 
                    absYear - remainder;
                
                const timelineContent = document.querySelector('.timeline-content');
                const yearMarkers = Array.from(timelineContent.querySelectorAll('.year-marker'));
                
                const matches = yearMarkers.filter(marker => {
                    const markerText = marker.textContent.trim();
                    const markerYear = parseInt(markerText.match(/-?\d+/)[0]);
                    const isBCEYear = markerText.includes('BCE');
                    
                    return Math.abs(markerYear) === roundedAbsYear && 
                        isBCEYear === isBCE;
                });

                if (matches.length > 0) {
                    setYearMatches(matches);
                    setYearMatchCount(matches.length);
                    setCurrentYearMatch(1);
                    highlightMatch(matches[0]);
                } else {
                    setYearMatches([]);
                    setYearMatchCount(0);
                    setCurrentYearMatch(0);
                }
            };

            const highlightMatch = (element) => {
                // Remove any existing highlights
                document.querySelectorAll('.timeline-item').forEach(item => {
                    item.style.boxShadow = 'none';
                });

                // Calculate scroll position
                const container = document.querySelector('.timeline-content');
                const containerRect = container.getBoundingClientRect();
                const elementRect = element.getBoundingClientRect();
                const relativeTop = elementRect.top - containerRect.top;
                const centerPosition = relativeTop - (containerRect.height / 2) + (elementRect.height / 2);

                // Smooth scroll the container
                container.scrollBy({
                    top: centerPosition,
                    behavior: 'smooth'
                });

                // Add highlight
                element.style.boxShadow = '0 0 10px rgba(59, 130, 246, 0.5)';

                // Remove highlight after delay
                setTimeout(() => {
                    element.style.boxShadow = 'none';
                }, 2000);
            };

            const navigateMatches = (direction, isYearSearch = false) => {
                const currentMatchState = isYearSearch ? currentYearMatch : currentMatch;
                const matchesArray = isYearSearch ? yearMatches : matches;
                
                if (matchesArray.length === 0) return;
                
                let nextMatch = direction === 'next' 
                    ? currentMatchState % matchesArray.length + 1
                    : currentMatchState === 1 ? matchesArray.length : currentMatchState - 1;
                
                if (isYearSearch) {
                    setCurrentYearMatch(nextMatch);
                } else {
                    setCurrentMatch(nextMatch);
                }
                highlightMatch(matchesArray[nextMatch - 1]);
            };



            return (
                <div className="container mx-auto">
                    <div style={{
                        display: 'flex',
                        alignItems: 'center',
                        padding: '0px',
                        gap: '40px',
                        marginBottom: '0px',
                        // *** PATH CORRECTION ***
                        backgroundImage: 'url("../other/title_background.jpg")',
                        backgroundSize: 'cover',
                        backgroundPosition: 'center',
                        minWidth: '100%',
                        minHeight: '100px',
                        position: 'relative'
                    }}>
                        <img 
                            // *** PATH CORRECTION ***
                            src="../other/olive.gif" 
                            alt="Logo" 
                            style={{
                                width: '100px',
                                height: '100px',
                                objectFit: 'contain'
                            }}
                        />
                        <h1 className="text-4xl font-bold text-gray-800" style={{
                            flex: 1,
                            marginLeft: '0px',
                            display: 'flex',
                            flexDirection: 'column',
                            alignItems: 'flex-start',
                            gap: '10px'
                        }}>
                            {currentLanguage === 'kurdish' ? "Kronolojiya Dîrokî ya Efrînê" : 
                            currentLanguage === 'arabic' ? "الجدول الزمني التاريخي لعفرين" : 
                            "Historical Timeline of Afrin"}
                            <div style={{
                                display: 'flex',
                                flexDirection: 'column',
                                gap: '5px'
                            }}>
                                <div style={{
                                    display: 'flex',
                                    gap: '15px',
                                    marginTop: '5px'
                                }}>
                                    <button 
                                        onClick={() => {
                                            setCurrentLanguage('english');
                                            setCurrentData(timelineData);
                                        }}
                                        style={{
                                            background: '#d4b642',
                                            color: 'white',
                                            padding: '15px 30px',
                                            border: 'none',
                                            borderRadius: '4px',
                                            opacity: currentLanguage === 'english' ? 0.7 : 1,
                                            cursor: 'pointer',
                                            transition: 'opacity 0.3s, transform 0.3s',
                                            fontSize: '18px'
                                        }}
                                        onMouseOver={(e) => e.currentTarget.style.transform = 'scale(1.05)'}
                                        onMouseOut={(e) => e.currentTarget.style.transform = 'scale(1)'}
                                    >
                                        English
                                    </button>
                                    <button 
                                        onClick={() => {
                                            setCurrentLanguage('kurdish');
                                            setCurrentData(timelineDataKurdish);
                                        }}
                                        style={{
                                            background: '#d4b642',
                                            color: 'white',
                                            padding: '15px 30px',
                                            border: 'none',
                                            borderRadius: '4px',
                                            opacity: currentLanguage === 'kurdish' ? 0.7 : 1,
                                            cursor: 'pointer',
                                            transition: 'opacity 0.3s, transform 0.3s',
                                            fontSize: '18px'
                                        }}
                                        onMouseOver={(e) => e.currentTarget.style.transform = 'scale(1.05)'}
                                        onMouseOut={(e) => e.currentTarget.style.transform = 'scale(1)'}
                                    >
                                        Kurdî
                                    </button>
                                    <button 
                                        onClick={() => {
                                            setCurrentLanguage('arabic');
                                            setCurrentData(timelineDataArabic);
                                        }}
                                        style={{
                                            background: '#d4b642',
                                            color: 'white',
                                            padding: '15px 30px',
                                            border: 'none',
                                            borderRadius: '4px',
                                            opacity: currentLanguage === 'arabic' ? 0.7 : 1,
                                            cursor: 'pointer',
                                            transition: 'opacity 0.3s, transform 0.3s',
                                            fontSize: '22px'
                                        }}
                                        onMouseOver={(e) => e.currentTarget.style.transform = 'scale(1.05)'}
                                        onMouseOut={(e) => e.currentTarget.style.transform = 'scale(1)'}
                                    >
                                        العربية
                                    </button>
                                </div>
                                {currentLanguage === 'kurdish' && (
                                    <div style={{ color: '#ff0000', fontSize: '16px', marginTop: '5px' }}>
                                        Hişyarî: Wergêran dibe ku ne rast bin. Ji bo rastiya çêtir, bi Îngilîzî bixwînin.
                                    </div>
                                )}
                                {currentLanguage === 'arabic' && (
                                    <div style={{ color: '#ff0000', fontSize: '16px', marginTop: '5px' }}>
                                        تحذير: قد تكون الترجمات غير دقيقة. اعرض باللغة الإنجليزية للحصول على دقة أفضل.
                                    </div>
                                )}
                            </div>
                        </h1>
                    </div>
                    
                    <div style={{ position: 'fixed', top: '50px', right: '20px', zIndex: 1000, display: 'flex', flexDirection: 'column', gap: '20px', maxWidth: '600px' }}>
                        <div style={{ display: 'flex', gap: '20px' }}>
                            <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                                <div style={{ position: 'relative' }}>
                                    <input 
                                        type="text" 
                                        id="searchInput"
                                        placeholder={currentLanguage === 'kurdish' ? "Lêgerîna nivîsê..." : 
                                                currentLanguage === 'arabic' ? "البحث عن النص..." :
                                                "Search text..."}
                                        style={{
                                            width: '200px',
                                            padding: '12px 32px 12px 12px',
                                            border: '1px solid #e2e8f0',
                                            borderRadius: '4px'
                                        }}
                                        onKeyPress={(e) => {
                                            if (e.key === 'Enter') {
                                                findMatches(false);
                                            }
                                        }}
                                        onChange={() => {
                                            if (!document.getElementById('searchInput').value) {
                                                setMatchCount(0);
                                                setCurrentMatch(0);
                                                setMatches([]);
                                                setSearchResults([]);
                                            }
                                        }}
                                    />
                                    <button 
                                        style={{
                                            position: 'absolute',
                                            right: '8px',
                                            top: '50%',
                                            transform: 'translateY(-50%)',
                                            background: '#d4b642',
                                            color: 'white',
                                            border: 'none',
                                            borderRadius: '4px',
                                            padding: '4px 8px',
                                            fontSize: '12px',
                                            cursor: 'pointer'
                                        }}
                                        onClick={() => findMatches(false)}
                                    >
                                        {currentLanguage === 'kurdish' ? "Lêgerîn" :
                                        currentLanguage === 'arabic' ? "بحث" :
                                        "Search"}
                                    </button>
                                </div>
                                {matchCount > 0 && (
                                    <span style={{ fontSize: '14px', color: '#666' }}>
                                        {matchCount} {currentLanguage === 'kurdish' ? "encam" :
                                                    currentLanguage === 'arabic' ? "نتيجة" :
                                                    "results"}
                                    </span>
                                )}
                            </div>
                            
                            <div style={{ display: 'inline-flex', alignItems: 'center', gap: '8px' }}>
                                <div style={{ position: 'relative', display: 'flex', alignItems: 'center', height: '40px' }}>
                                    <input 
                                        type="number" 
                                        id="yearSearchInput"
                                        placeholder={currentLanguage === 'kurdish' ? "Lêgerîna salê..." :
                                                currentLanguage === 'arabic' ? "البحث عن السنة..." :
                                                "Search year..."}
                                        style={{
                                            width: '120px',
                                            height: '100%',
                                            padding: '0 32px 0 12px',
                                            border: '1px solid #e2e8f0',
                                            borderRadius: '4px 0 0 4px',
                                            borderRight: 'none'
                                        }}
                                        onKeyPress={(e) => {
                                            if (e.key === 'Enter') {
                                                findMatches(true);
                                            }
                                        }}
                                        onChange={() => {
                                            if (!document.getElementById('yearSearchInput').value) {
                                                setYearMatchCount(0);
                                                setCurrentYearMatch(0);
                                                setYearMatches([]);
                                            }
                                        }}
                                    />
                                    <div style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        height: '100%',
                                        gap: '8px',
                                        padding: '0 12px',
                                        backgroundColor: 'white',
                                        border: '1px solid #e2e8f0',
                                        borderLeft: 'none',
                                        borderRadius: '0 4px 4px 0'
                                    }}>
                                        <input
                                            type="checkbox"
                                            checked={isBCE}
                                            onChange={(e) => setIsBCE(e.target.checked)}
                                            style={{ 
                                                cursor: 'pointer',
                                                width: '20px',
                                                height: '20px',
                                                accentColor: '#e2e8f0'
                                            }}
                                        />
                                        <span style={{ fontSize: '14px' }}>BCE</span>
                                        <button 
                                            style={{
                                                background: '#d4b642',
                                                color: 'white',
                                                border: 'none',
                                                borderRadius: '4px',
                                                padding: '4px 8px',
                                                fontSize: '12px',
                                                cursor: 'pointer',
                                                marginLeft: '8px',
                                                height: '24px'
                                            }}
                                            onClick={() => findMatches(true)}
                                        >
                                            {currentLanguage === 'kurdish' ? "Lêgerîn" :
                                            currentLanguage === 'arabic' ? "بحث" :
                                            "Search"}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {searchResults.length > 0 && (
                            <div 
                                ref={searchResultsRef}
                                style={{
                                    background: 'white',
                                    padding: '12px',
                                    borderRadius: '4px',
                                    boxShadow: '0 2px 4px rgba(0, 0, 0, 0.1)',
                                    maxHeight: '200px',
                                    overflowY: 'auto'
                                }}
                            >
                                <h3 style={{ marginBottom: '8px', fontWeight: 'bold' }}>
                                    {currentLanguage === 'kurdish' ? "Encamên lêgerînê:" :
                                    currentLanguage === 'arabic' ? "نتائج البحث:" :
                                    "Search Results:"}
                                </h3>
                                {searchResults.map((result, index) => {
                                    const text = result.sentence;
                                    const parts = text.split(/(\*\*.*?\*\*)/);
                                    
                                    return (
                                        <div 
                                            key={index} 
                                            style={{
                                                padding: '8px',
                                                borderBottom: index < searchResults.length - 1 ? '1px solid #e2e8f0' : 'none',
                                                cursor: 'pointer',
                                                transition: 'background-color 0.2s',
                                                ':hover': {
                                                    backgroundColor: '#f3f4f6'
                                                }
                                            }}
                                            onClick={() => highlightMatch(result.element)}
                                        >
                                            {parts.map((part, i) => {
                                                if (part.startsWith('**') && part.endsWith('**')) {
                                                    // Handle bold text
                                                    const innerText = part.slice(2, -2);
                                                    // Split words and check each for search term
                                                    const words = innerText.split(/(\s+)/);
                                                    return (
                                                        <strong key={i}>
                                                            {words.map((word, j) => {
                                                                if (word.toLowerCase().startsWith(searchInput.value.toLowerCase()) && word.trim().length > 0) {
                                                                    return <span key={j} style={{ color: '#3b82f6' }}>{word}</span>;
                                                                }
                                                                return <span key={j}>{word}</span>;
                                                            })}
                                                        </strong>
                                                    );
                                                }
                                                // Handle regular text
                                                const words = part.split(/(\s+)/);
                                                return (
                                                    <span key={i}>
                                                        {words.map((word, j) => {
                                                            if (word.toLowerCase().startsWith(searchInput.value.toLowerCase()) && word.trim().length > 0) {
                                                                return <span key={j} style={{ color: '#3b82f6' }}>{word}</span>;
                                                            }
                                                            return <span key={j}>{word}</span>;
                                                        })}
                                                    </span>
                                                );
                                            })}
                                        </div>
                                    );
                                })}
                            </div>
                        )}
                    </div>
                    <Timeline columns={columns} startYear={startYear} endYear={endYear} />
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
